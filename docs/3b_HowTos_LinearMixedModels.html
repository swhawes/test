<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.333">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Biostatistics Working Group">

<title>Longitudinal Analysis - Linear Mixed Models: Random Intercept and Slope</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4_HowTos_SignedRankTest.html" rel="next">
<link href="./3a_HowTos_LinearMixedModels.html" rel="prev">
<link href="././figures/lights.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Longitudinal Analysis - Linear Mixed Models: Random Intercept and Slope">
<meta name="twitter:image" content="https://swhawes.github.io/test/3b_HowTos_LinearMixedModels_files/figure-html/my-figure-1.png">
<meta name="twitter:image-height" content="819">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Longitudinal Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./manuscript.html" rel="" target="">
 <span class="menu-text">Manuscript</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./tutorials.html" rel="" target="">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./howto.html" rel="" target="">
 <span class="menu-text">How-To</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./explanations.html" rel="" target="">
 <span class="menu-text">Explanations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./reference.html" rel="" target="">
 <span class="menu-text">Reference</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://twitter.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/swhawes/test">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/swhawes/test/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Traditional Linear Models</li><li class="breadcrumb-item"><a href="./3a_HowTos_LinearMixedModels.html">Linear Mixed Models</a></li><li class="breadcrumb-item"><a href="./3b_HowTos_LinearMixedModels.html">Linear Mixed Models: Random Intercept and Slope</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="././figures/lights.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://twitter.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/swhawes/test">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/swhawes/test/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./howto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How-Toâ€™s: A Brief Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Traditional Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Difference Scores</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1a_HowTos_DifferenceScores_PairedTtests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference Scores: Paired Samples T-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1b_HowTos_DifferenceScores_SimpleRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference Scores: Simple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Residualized Change Scores</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_HowTos_ResidualizedChangeScores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Residualized Change Scores</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Linear Mixed Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3a_HowTos_LinearMixedModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Mixed Models: Random Intercept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3b_HowTos_LinearMixedModels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Linear Mixed Models: Random Intercept and Slope</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Traditional Non-linear Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Signed-Rank Test</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_HowTos_SignedRankTest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Signed-Rank Test</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Marginal Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_HowTos_MarginalModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Marginal Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">Generalized Estimating Equations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_HowTos_GeneralizedEstimatingEquations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Estimating Equations</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
 <span class="menu-text">Generalized Linear Mixed-Effects Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_HowTos_GeneralizedLinearMixedEffectsModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Linear Mixed Effects Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
 <span class="menu-text">SEM Approaches</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">Autoregressive Crosslagged Panel Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_HowTos_AutoregressiveCrosslaggedPanelModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autoregressive Crosslagged Panel Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">Latent Change Scores Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_HowTos_LatentChangeScoresModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Change Score Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
 <span class="menu-text">LatentGrowthCurveModels</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_HowTos_LatentGrowthCurveModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
 <span class="menu-text">Multivariate Latent Growth Curve Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_HowTos_MultivariateLatentGrowthCurveModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate Latent Growth Curve Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">
 <span class="menu-text">Latent Transition Analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_HowTos_LatentTransitionAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Transition Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">
 <span class="menu-text">Growth Mixture Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_HowTos_GrowthMixtureModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Growth Mixture Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false">
 <span class="menu-text">State-Trait Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_HowTos_StateTraitModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">State-Trait Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" aria-expanded="false">
 <span class="menu-text">Advanced SEM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_HowTos_RandomInterceptCrosslaggedPanelModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random-Intercept Crosslagged Panel Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_HowTos_LatentCurveModelsStructuredResiduals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Curve Models with Structured Residuals</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" aria-expanded="false">
 <span class="menu-text">Longitudinal Neuroimaging</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blank Test Page</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" aria-expanded="false">
 <span class="menu-text">Twin Modeling &amp; Genetics Designs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blank Test Page</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#lmm-intercept-slope" id="toc-lmm-intercept-slope" class="nav-link active" data-scroll-target="#lmm-intercept-slope">LMM: Intercept &amp; Slope</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Linear Mixed Models: Random Intercept and Slope</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Biostatistics Working Group </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="lmm-intercept-slope" class="level1 unnumbered">
<h1 class="unnumbered">LMM: Intercept &amp; Slope</h1>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>
In this example, we will use the <strong><code>LMM:ri</code></strong> to analyze trajectories of scores on the externalizing subscale of the child behavior checklist (CBCL) obtained across three measurement occasions in a sample of youth taking part in the ABCD Study. Our primary aim is to characterize stability and change in CBCL externalizing scores across assessments, while accounting for observations that are clustered within youth over time. To do so, we will use the <strong><code>LMM:ri</code></strong> to simultaneously model an overall sample mean trajectory (fixed effect) and subject-specific (random) effects that vary randomly about the sample mean trajectory.
</p>
</section>
<section id="preliminary-setup" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-setup">Preliminary Setup</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Install Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Load Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Config Options</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="blue">
<blockquote class="blockquote">
<p><strong>This code installs the r packages necessary for this example, if they are not already installed</strong></p>
</blockquote>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="blue">
<blockquote class="blockquote">
<p><strong>This code loads the r libraries necessary for this example</strong></p>
</blockquote>
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/pckg-load_8cb1796cb1074dc2bb296c9b64071204">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r fold-hide number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#Load packages</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#library(lme4)</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#library(lmerTest)</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#library(tidyverse)</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#library(afex)</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#library(janitor)</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#library(skimr)</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#library(sdamr)</span></span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(arrow)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">library</span>(afex)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu">library</span>(skimr)</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="fu">library</span>(formatR)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu">library</span>(report)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">library</span>(easystats)</span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu">library</span>(poorman)</span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">library</span>(parameters)</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="fu">library</span>(arsenal)</span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="fu">library</span>(equatiomatic)</span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="blue">
<p><strong>This code configures knitr code chunk options</strong></p>
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/config_fcd478c6f74825dbb563adbce0ba8ece">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> T, <span class="at">message=</span>F, <span class="at">warning=</span>F, <span class="at">error=</span>F, </span>
<span id="cb2-2"><a href="#cb2-2"></a>                        <span class="at">comment=</span><span class="cn">NA</span>, <span class="at">cache=</span>T, <span class="at">code_folding=</span>T,</span>
<span id="cb2-3"><a href="#cb2-3"></a>                        <span class="at">R.options=</span><span class="fu">list</span>(<span class="at">width=</span><span class="dv">220</span>), <span class="at">fig.align=</span><span class="st">'center'</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>                        <span class="at">out.width=</span><span class="st">'75%'</span>, <span class="at">fig.asp=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="descriptives-overview" class="level2">
<h2 class="anchored" data-anchor-id="descriptives-overview">Descriptives Overview</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Read and View Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Descriptives</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="blue">
<p><strong>This code reads in and shows the data to be used in the current example</strong></p>
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/read-data_1154d18fb575145b9eea371918118280">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="do">## Read data</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>df_long<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/shawes/Desktop/data/df_long.csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#df_wide &lt;- read_csv("/path/to/datafile")</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># set types (if necessary)</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#df_long$x &lt;- as.factor(df_long$x)</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#df_long$y &lt;- as.numeric(df_long$y)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/descriptives_b82866c928c92d42929b71f11881fe5f">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb4-2"><a href="#cb4-2"></a>descriptives_1  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>                                               ), <span class="co">#"Nmiss2"</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co">#"Nmiss2"</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb4-8"><a href="#cb4-8"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>                                                 )) <span class="co">#, Nmiss2 ='Missing'</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a>my_cont_labels <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="at">age =</span> <span class="st">"Age"</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="at">vg_total =</span> <span class="st">"Weekly # of Video Gaming Hrs"</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="at">cbcl_extern =</span> <span class="st">"CBCL Externalizing Scale"</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>)</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a>tab_descriptives_1 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> age <span class="sc">+</span> vg_total <span class="sc">+</span> </span>
<span id="cb4-18"><a href="#cb4-18"></a>                            cbcl_extern,</span>
<span id="cb4-19"><a href="#cb4-19"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_1)</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#summary(tab_descriptives_1, labelTranslations = my_cont_labels , text=TRUE, title = #"Continuous Outcomes", term.name = TRUE)</span></span>
<span id="cb4-22"><a href="#cb4-22"></a></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>tab_descriptives_1 <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Continuous Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="#cb4-27"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>,</span>
<span id="cb4-28"><a href="#cb4-28"></a>                <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb4-29"><a href="#cb4-29"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-35"><a href="#cb4-35"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:75%; ">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<caption>Continuous Outcomes</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Baseline (N=35)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_1 (N=34)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_2 (N=30)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">age</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">34</td>
<td style="text-align: left; vertical-align: middle !important;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">9.3 (0.5)</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">9.5 (0.5)</td>
<td style="text-align: left; vertical-align: middle !important;">9.6 (0.5)</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.5</td>
<td style="text-align: left;">10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.0 - 10.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.0 - 10.0</td>
<td style="text-align: left;">9.0 - 10.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">vg_total</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">34</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">8.7 (8.4)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">8.7 (8.1)</td>
<td style="text-align: left;">6.8 (4.3)</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">6.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">7.0</td>
<td style="text-align: left;">7.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 28.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 28.0</td>
<td style="text-align: left;">1.0 - 16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">cbcl_extern</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">34</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">4.8 (5.7)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">5.5 (6.1)</td>
<td style="text-align: left;">6.9 (6.9)</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">3.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">4.0</td>
<td style="text-align: left;">4.5</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 21.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 25.0</td>
<td style="text-align: left;">0.0 - 25.0</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Here is a general comments of the table.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>
</div>

</div>
</div>
</div>
<div class="blue">
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/catvar-table_f33eb1ff68995cc3fee4d88d8a5a7403">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb5-2"><a href="#cb5-2"></a>descriptives_2  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>                                               ), <span class="co"># "Nmiss2"</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co"># "Nmiss2"</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb5-8"><a href="#cb5-8"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>                                                 )) <span class="co"># , Nmiss2 ='Missing'</span></span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>my_cat_labels  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="at">event =</span> <span class="st">"Year"</span>,</span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="at">sex =</span> <span class="st">"Sex"</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="at">mature_vg =</span> <span class="st">"Mature Video Games"</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  )</span>
<span id="cb5-16"><a href="#cb5-16"></a></span>
<span id="cb5-17"><a href="#cb5-17"></a>tab_descriptives_2 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> sex <span class="sc">+</span> mature_vg, </span>
<span id="cb5-18"><a href="#cb5-18"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_2)</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#summary(tab_descriptives_2, labelTranslations = my_cat_labels , text=TRUE, title = #"Categorical Outcomes", term.name = TRUE)</span></span>
<span id="cb5-21"><a href="#cb5-21"></a></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb5-23"><a href="#cb5-23"></a>tab_descriptives_2 <span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Categorical Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb5-27"><a href="#cb5-27"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>  <span class="co">#column_spec(3, width = "20em", border_right = T) %&gt;%</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-33"><a href="#cb5-33"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:75%; ">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<caption>Categorical Outcomes</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Baseline (N=35)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_1 (N=34)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_2 (N=30)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">sex</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Female</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">19 (54.3%)</td>
<td style="text-align: left; vertical-align: middle !important;">20 (58.8%)</td>
<td style="text-align: left; vertical-align: middle !important;">17 (56.7%)</td>
</tr>
<tr class="odd">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Male</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">16 (45.7%)</td>
<td style="text-align: left; vertical-align: middle !important;">14 (41.2%)</td>
<td style="text-align: left; vertical-align: middle !important;">13 (43.3%)</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">mature_vg</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left;">34</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.6 (0.9)</td>
<td style="text-align: left;">1.7 (6.3)</td>
<td style="text-align: left;">0.6 (0.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0</td>
<td style="text-align: left;">0.0</td>
<td style="text-align: left;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 3.0</td>
<td style="text-align: left;">0.0 - 37.0</td>
<td style="text-align: left;">0.0 - 3.0</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Here is a general comments of the table.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>
</div>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div class="blue">
<p>::: panel-tabset ### Build Model {.tabset .tabset-fade .tabset-pills}</p>
<p>::: blue</p>
<p>The code snippet below tells R to compute xxxxx by xxxxxxx. Next, xxxxx is conducted to examine whether xxxxxx does xxxxxxx (indicating xxxxx). The xxxx function (xxx) is provided by the r â€˜xxxâ€™ package. The code above is very similar to the code for the random intercept model, except that now we use the code (1 + Days | Subject) to specify a random intercept for each Subject, and a random slope of Days for each Subject. This allows both the intercept and the slope of days to vary across participants.</p>
<p><strong>STEP 1: Compute xxxxxxxx</strong></p>
<div class="cell" data-hash="3b_HowTos_LinearMixedModels_cache/html/build-model-1_1da6a40f2f1e29fb0a24ab437b2bdf3c">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r fold-hide number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="do">## Linear Mixed Model with a random intercept (LMM-ri)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#really still an intercept only model</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>random_slopes <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> event <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ids), <span class="at">data =</span> df_long, <span class="at">REML=</span>F)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">print</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerModLmerTest']
Formula: cbcl_extern ~ 1 + event + (1 | ids)
   Data: df_long
      AIC       BIC    logLik  deviance  df.resid 
 606.4845  619.4601 -298.2423  596.4845        94 
Random effects:
 Groups   Name        Std.Dev.
 ids      (Intercept) 4.881   
 Residual             3.528   
Number of obs: 99, groups:  ids, 37
Fixed Effects:
(Intercept)  eventYear_1  eventYear_2  
     4.5897       0.7558       1.7460  </code></pre>
</div>
</div>
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/model-output_746785ee6aef6e9a45f61bf909e63335">
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">summary</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: cbcl_extern ~ 1 + event + (1 | ids)
   Data: df_long

     AIC      BIC   logLik deviance df.resid 
   606.5    619.5   -298.2    596.5       94 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.7525 -0.4865 -0.1845  0.2842  2.9679 

Random effects:
 Groups   Name        Variance Std.Dev.
 ids      (Intercept) 23.82    4.881   
 Residual             12.45    3.528   
Number of obs: 99, groups:  ids, 37

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   4.5897     1.0059 59.7864   4.563 2.56e-05 ***
eventYear_1   0.7558     0.8618 64.8217   0.877   0.3837    
eventYear_2   1.7460     0.9021 65.6574   1.935   0.0572 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) evnY_1
eventYear_1 -0.419       
eventYear_2 -0.401  0.475</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">## Output and reports extending from the LMM-ri analyses</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">summary</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: cbcl_extern ~ 1 + event + (1 | ids)
   Data: df_long

     AIC      BIC   logLik deviance df.resid 
   606.5    619.5   -298.2    596.5       94 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.7525 -0.4865 -0.1845  0.2842  2.9679 

Random effects:
 Groups   Name        Variance Std.Dev.
 ids      (Intercept) 23.82    4.881   
 Residual             12.45    3.528   
Number of obs: 99, groups:  ids, 37

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   4.5897     1.0059 59.7864   4.563 2.56e-05 ***
eventYear_1   0.7558     0.8618 64.8217   0.877   0.3837    
eventYear_2   1.7460     0.9021 65.6574   1.935   0.0572 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) evnY_1
eventYear_1 -0.419       
eventYear_2 -0.401  0.475</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">confint</span>(random_slopes, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %   97.5 %
.sig01               NA       NA
.sigma               NA       NA
(Intercept)  2.61814609 6.561329
eventYear_1 -0.93332355 2.445020
eventYear_2 -0.02209218 3.514008</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">report</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using ML and nloptwrap optimizer) to
predict cbcl_extern with event (formula: cbcl_extern ~ 1 + event). The model
included ids as random effect (formula: ~1 | ids). The model's total
explanatory power is substantial (conditional R2 = 0.66) and the part related
to the fixed effects alone (marginal R2) is of 0.01. The model's intercept,
corresponding to event = Baseline, is at 4.59 (95% CI [2.59, 6.59], t(94) =
4.56, p &lt; .001). Within this model:

  - The effect of event [Year_1] is statistically non-significant and positive
(beta = 0.76, 95% CI [-0.96, 2.47], t(94) = 0.88, p = 0.383; Std. beta = 0.12,
95% CI [-0.15, 0.40])
  - The effect of event [Year_2] is statistically non-significant and positive
(beta = 1.75, 95% CI [-0.05, 3.54], t(94) = 1.94, p = 0.056; Std. beta = 0.28,
95% CI [-7.28e-03, 0.57])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">report_performance</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The model's total explanatory power is substantial (conditional R2 = 0.66) and
the part related to the fixed effects alone (marginal R2) is of 0.01</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">report_statistics</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>beta = 4.59, 95% CI [2.59, 6.59], t(94) = 4.56, p &lt; .001; Std. beta = -0.17, 95% CI [-0.50, 0.15]
beta = 0.76, 95% CI [-0.96, 2.47], t(94) = 0.88, p = 0.383; Std. beta = 0.12, 95% CI [-0.15, 0.40]
beta = 1.75, 95% CI [-0.05, 3.54], t(94) = 1.94, p = 0.056; Std. beta = 0.28, 95% CI [-7.28e-03, 0.57]</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_grouplevel</span>(random_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p>The summary function is used to print out the results from the random intercept model and</p>
<p><strong>STEP 2: Conduct xxxxxxx</strong></p>
<div class="cell" data-hash="3b_HowTos_LinearMixedModels_cache/html/build-model-2_f310f255431d1ae03758eda4fb57d638">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r fold-hide number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="do">## Obtain LMM-ri model parameters to plot/graph of results</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="do">## Fixed-Effects</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>model_intercept <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">coef</span>(random_slopes)<span class="sc">$</span>ids[,<span class="dv">1</span>], <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>slopes2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">coef</span>(random_slopes)<span class="sc">$</span>ids[,<span class="dv">2</span>], <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#This code allows for extracting the fixed effects estimates for the model intercept and slope.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The output from our model provides: i. a parameter estimate; ii. standard error; iii. p-value. In our example p = .001 which is less than .05 indicating significant differences in predicted cbcl externalizing scores between boys and girls in the ABCD Study. An examination of the regression coeefficient for sex (female = 0; male = 1) is b = .xx, indicating the difference in cbcl externalizing scores from Time 1 to Time 2 is significantly greater in boys taking part in the ABCD Study relative to girls. Then we conclude that participant sex (does/does not) predict change in cbcl externalizing scores from t1 to t2.</p>
<p>From the fixed effects section of the model summary, we can conclude that there is strong evidence that number of days of sleep deprivation significantly increased reaction time under a significance level of 0.05. On average, for each additional day of sleep deprivation, reaction time increased by 10.47ms (b = 10.47, SE = 1.55, p &lt; .001).</p>
<p>We are 95% confident that the average increase was between 7.44 and 13.50.</p>
<p>From the fixed effects section, we estimated the average intercept and average effect of days of sleep deprivation (slopes of Days). We also estimated the corresponding 95% confidence intervals. Using the results from the random effects section, we can calculate the coverage intervals for both the intercept and the slope.</p>
<p>The variance of the intercept and for the slope of Days is 612.1 and 35.1 respectively. Taking their square root, the corresponding standard deviations are 24.7 and 5.9. The 95% coverage interval of the intercept is 251.4 Â± 1.96*24.7. The lower bound is 203.0 and the upper bound is 299.8. It is therefore estimated that 95% of the participants had a reaction time between 203.0 and 299.8 at Day 0.</p>
<p>The 95% coverage interval of the slope of Days is 10.5 Â± 1.96*5.9. The lower bound is -1.1 and the upper bound is 22.1. It is therefore estimated that for 95% of the participants, the effect of each additional day of sleep deprivation was between -1.1 and 22.1. This is not to be confused with the 95% confidence interval (7.4 and 13.5), which means that we are 95% confident that average effect (across all participants) of each additional day of sleep deprivation on reaction time was between 7.4 and 13.5. The model now estimates a variance of the random slopes effects, as well as a correlation between the random intercept and slope effects. :::</p>
<div class="cell" data-hash="3b_HowTos_LinearMixedModels_cache/html/unnamed-chunk-2_b53893363849c48651d18fa90e647388">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># # ! THIS PLOT RUNS &amp; PRINTS TO SCREEN. I am temporarily commenting it out due to a side-effect of the </span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># #"intercepts2 variable"</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co"># ggplot(df_long, aes(x = event, y = cbcl_extern)) + </span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#   geom_abline(model_slope = slopes2, model_intercept = intercepts2, </span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#               linetype = "solid", color = "black", linewidth = 1) + </span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#   # geom_abline(mapping = aes(slopes2 = model_slope, intercepts2 = model_intercept, linetype = PID), </span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#   #             linetype = "dashed", color = "grey70", linewidth = .4) +</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#   #geom_point(aes(shape = ids), size = 3.25, color = "grey70") + </span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#   #scale_shape_manual() + </span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#   # geom_segment(aes(x = event, xend = event, </span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#   #                  y = cbcl1, yend = fitted(model_slope)), </span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">#   #              color = "grey70") +</span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co">#   scale_y_continuous(expand = c(0, 0), breaks = c(0, 100, 200, 300, 400, 500), </span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co">#                      limits = c(0, 500)) +</span></span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co">#   scale_x_continuous(expand = c(0, 0), breaks = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9), </span></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co">#                      limits = c(-0.5, 10.5)) +</span></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co">#   theme(panel.background = element_blank(),         </span></span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="co">#           panel.grid.major = element_blank(),</span></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co">#             panel.grid.minor = element_blank(),</span></span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="co">#             panel.border = element_rect(colour = "black", fill = NA),</span></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="co">#           legend.position = "none", </span></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="co">#           axis.text = element_text(size = 14),</span></span>
<span id="cb22-23"><a href="#cb22-23"></a><span class="co">#           axis.title = element_text(size = 14)) +</span></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co">#     labs (x = "event", y = "cbcl_extern") </span></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="co">#   </span></span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="co"># #Save the figure</span></span>
<span id="cb22-27"><a href="#cb22-27"></a><span class="co">#  ggsave("random_slopes.png", units = "in", width = 9, height = 6, dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="model-plots" class="level3">
<h3 class="anchored" data-anchor-id="model-plots">Model Plots</h3>
<p>:::blue</p>
<div class="cell" data-hash="3b_HowTos_LinearMixedModels_cache/html/diag-plots_0aa0b6f5394197c5b90cb1f5eee7f7f4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># #| messages: FALSE</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># #| warning: FALSE</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co"># #| echo: FALSE</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co"># #| column: screen-inset-shaded</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># #| layout-nrow: 2</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#     </span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># ## xxxxx plot</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co"># random_intercepts.std &lt;- resid(model_intercept)/sd(resid(model_intercept))</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co"># plot (random_intercepts.std, ylab="Standardized Residuals")</span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co"># </span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co"># ## Outlier Tests. </span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co"># #car::outlierTest(random_intercepts)</span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co"># car::infIndexPlot(random_intercepts)</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co"># </span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co"># ## qqplot</span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co"># ggplot(as.data.frame(random_intercepts.std), aes(sample = random_intercepts.std)) +</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">#   geom_qq() +</span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co">#   geom_qq_line()</span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co"># </span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co"># ## Predicted vs Actual plot</span></span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="co"># predicted &lt;- estimate_expectation(random_intercepts, data = "grid")</span></span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="co"># plot(predicted)</span></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co"># </span></span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="co"># ## Estimated means plot</span></span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="co"># means &lt;- estimate_means(random_intercepts)</span></span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="co"># plot(means)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#Build diagnostic plots. Observations with a Bonferroni p &lt; .05 might #be considered as outliers and might need further investigation. Examination of this scatterplot indicates xxxxx.</p>
<div class="cell" data-messages="false" data-hash="3b_HowTos_LinearMixedModels_cache/html/barplot_a45fd588ee52720d72bd2f592cfc0133">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Basic ggplot2 barplot with mean</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>p <span class="ot">&lt;-</span>df_long <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(event)) <span class="sc">%&gt;%</span> <span class="co"># filter on non-missing values  </span></span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> cbcl_extern, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>           <span class="at">stat =</span> <span class="st">"summary"</span>,</span>
<span id="cb24-7"><a href="#cb24-7"></a>           <span class="at">fun =</span> <span class="st">"mean"</span>,</span>
<span id="cb24-8"><a href="#cb24-8"></a>           <span class="co">#fill = "#AA4A44",</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>           <span class="co">#color = "#0099f9"</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>           ) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>    <span class="co">#scale_fill_brewer(palette = "Set1") +</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3db5ff"</span>, <span class="st">"#0099f9"</span>)) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>    <span class="co">#scale_fill_gradient(high = "#B00B69", low = "#0e0e63") +</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>    <span class="co">#geom_text(aes(label = cu_traits), position = position_dodge(0.9), </span></span>
<span id="cb24-15"><a href="#cb24-15"></a>              <span class="co">#vjust = 2, size = 4, color = "#ffffff") +</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Behavior Problems by Video Game Groups"</span>, <span class="at">subtitle =</span> <span class="st">"Simple bar chart"</span>,</span>
<span id="cb24-17"><a href="#cb24-17"></a>         <span class="at">caption =</span> <span class="st">"Simple caption"</span>, <span class="at">x =</span> <span class="st">"DBD Group"</span>, <span class="at">y =</span> <span class="st">"CBCL Externalizing"</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>              <span class="co">#coord_flip() +</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>    <span class="co">#geom_hline(yintercept = mean(df$cbcl_agg), linetype = "dashed", size = 1) +</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>    <span class="fu">theme</span>(</span>
<span id="cb24-22"><a href="#cb24-22"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-23"><a href="#cb24-23"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb24-24"><a href="#cb24-24"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb24-25"><a href="#cb24-25"></a>            <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb24-26"><a href="#cb24-26"></a>            <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb24-27"><a href="#cb24-27"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Examination of this scatterplot indicates xxxxx.</p>
<div class="cell" data-messages="false" data-fig.asp="0.61" data-hash="3b_HowTos_LinearMixedModels_cache/html/my-figure_7f7eba8ab712ca382ed65e323b789285">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">#Random Intercept LMM Plot/Graph</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#random_intercepts &lt;- lmer(Externalizing ~ 1 + Event + DBD + Sex + (1|ids), data = df, #REML=T)</span></span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="do">##  LMM-ri plot of estimated random intercepts </span></span>
<span id="cb25-5"><a href="#cb25-5"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> mature_vg <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> sex), <span class="at">data =</span> df_long)</span>
<span id="cb25-6"><a href="#cb25-6"></a>preds <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model, <span class="at">include_random =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-7"><a href="#cb25-7"></a>    </span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="do">## Adding fixed effect trajectory to LMM-ri plot </span></span>
<span id="cb25-9"><a href="#cb25-9"></a>fixed_pred <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model) <span class="co"># This time, include_random is FALSE (default)</span></span>
<span id="cb25-10"><a href="#cb25-10"></a> <span class="fu">plot</span>(preds, <span class="at">ribbon =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># Previous plot</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">ymin =</span> CI_low, <span class="at">ymax =</span> CI_high), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> Predicted), <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="3b_HowTos_LinearMixedModels_files/figure-html/my-figure-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># ggplot(df_long_sub, aes(x = event, y = cbcl_agg, color=sex, shape=sex)) + </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co"># geom_abline(slope = model_slope, intercept = model_intercept, linetype = "solid", color = "red", linewidth = 1) + </span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co"># geom_point(color = "grey70") + </span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># geom_smooth(method=lm, se=FALSE, fullrange=TRUE)+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># scale_shape() + </span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co"># geom_segment(aes(x = event, xend = event, y = cbcl_agg, yend = fitted(cbcl_agg)), color = "grey70") + </span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co"># scale_y_continuous(expand = c(0, 0), breaks = c(0, 20, 40, 60, 80, 100), limits = c(0, 100)) + </span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4), limits = c(0, 4)) +</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co"># theme(panel.background = element_blank(),         </span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#         panel.grid.major = element_blank(),</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#         panel.grid.minor = element_blank(),</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#         panel.border = element_rect(colour = "black", fill = NA),</span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#         legend.position = "none",</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#         axis.text = element_text(size = 14), </span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#         axis.title = element_text(size = 14)) +</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#         labs (x = "Event", y= "CBCL Aggression")</span></span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co">#Save the plot</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">#ggsave("random_intercept.png", units = "in", width = 9, height = 6, dpi = 300)  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p class="text-center" style="background-color: gray">
Figure x: The overall group-mean (fixed effects) trajectory is shown in blue. The faded lines represent each individual youthâ€™s estimated trajectory. An examination of this figure shows happiness scores to be increasing across measurement occasions, however, there appears to be substantial variability in the youthâ€™s initial happiness scores.
</p>
<p>Examination of this barplot indicates xxxxx.</p>
</section>
</section>
<section id="wrapping-up" class="level2">
<h2 class="anchored" data-anchor-id="wrapping-up">Wrapping Up</h2>
<div class="blue">

<div class="blue">

<p>::: panel-tabset ### Write-up {.tabset .tabset-fade .tabset-pills}</p>
<div class="blue">
<p>A random slope model is used to test if sleep deprivation affects reaction time. To account for the repeated measures design, a random intercept was specified for participants. The random slope for days of sleep deprivation was included in the model to allow the effect of sleep deprivation to vary across participants. Results are shown in Table 1. Using a significant level of 0.05, results indicate that sleep deprivation significantly increased reaction time. On average, each additional day of sleep deprivation increased reaction time by 10.47ms (b = 10.47, 95% CI = [7.44, 13.50], p &lt; .001). Model fit comparison between model with and without random slope for sleep deprivation shows that the effect of sleep deprivation varied across participants, Ï‡2(2)= 42.14, p &lt; .001. The 95% coverage interval for the random slope of sleep deprivation is (-1.14, 22.07), indicating that the effect of sleep deprivation was between -1.14 and 22.07 for 95% of the participants.</p>
</div>
</div></div></section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p><span class="citation" data-cites="brown2021">(<a href="#ref-brown2021" role="doc-biblioref"><strong>brown2021?</strong></a>)</span> <!-- [@Singmann2019]
[@sarafian]
[#@https://m-clark.github.io/]
[#@Fitzmaurice]
[#@mspeekenbrink.github.io]
[#https://cran.r-project.org/web/packages/lme4/lme4.pdf] --></p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/swhawes\.github\.io\/test\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./3a_HowTos_LinearMixedModels.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Linear Mixed Models: Random Intercept</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4_HowTos_SignedRankTest.html" class="pagination-link">
        <span class="nav-page-text">Signed-Rank Test</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb27" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">---</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="an">title:</span><span class="co"> "Linear Mixed Models: Random Intercept and Slope"</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="an">author:</span><span class="co"> "Biostatistics Working Group"</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">---</span></span>
<span id="cb27-5"><a href="#cb27-5"></a></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="fu"># LMM: Intercept &amp; Slope {.unnumbered}</span></span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="fu">## Overview</span></span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="kw">&lt;p&gt;</span></span>
<span id="cb27-11"><a href="#cb27-11"></a></span>
<span id="cb27-12"><a href="#cb27-12"></a>In this example, we will use the **`LMM:ri`** to analyze trajectories of scores on the externalizing subscale of the child behavior checklist (CBCL) obtained across three measurement occasions in a sample of youth taking part in the ABCD Study. Our primary aim is to characterize stability and change in CBCL externalizing scores across assessments, while accounting for observations that are clustered within youth over time. To do so, we will use the **`LMM:ri`** to simultaneously model an overall sample mean trajectory (fixed effect) and subject-specific (random) effects that vary randomly about the sample mean trajectory. </span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="kw">&lt;/p&gt;</span></span>
<span id="cb27-14"><a href="#cb27-14"></a></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="fu">## Preliminary Setup</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>::: {.panel-tabset}</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="fu">### Install Packages {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-19"><a href="#cb27-19"></a></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="at">&gt; **This code installs the r packages necessary for this example, if they are not already installed**</span></span>
<span id="cb27-21"><a href="#cb27-21"></a></span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="in">```{r}</span></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="co">#| class.source: 'fold-hide'</span></span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="co">#| message: FALSE</span></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb27-31"><a href="#cb27-31"></a></span>
<span id="cb27-32"><a href="#cb27-32"></a><span class="co"># Install necessary packages (if not already installed)</span></span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"lme4"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"lme4"</span>)</span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"lmerTest"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"lmerTest"</span>)</span>
<span id="cb27-35"><a href="#cb27-35"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"tidyverse"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"afex"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"afex"</span>)</span>
<span id="cb27-37"><a href="#cb27-37"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"sdamr"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"sdamr"</span>)</span>
<span id="cb27-38"><a href="#cb27-38"></a><span class="in">```</span></span>
<span id="cb27-39"><a href="#cb27-39"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-40"><a href="#cb27-40"></a></span>
<span id="cb27-41"><a href="#cb27-41"></a><span class="fu">### Load Packages</span></span>
<span id="cb27-42"><a href="#cb27-42"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-43"><a href="#cb27-43"></a></span>
<span id="cb27-44"><a href="#cb27-44"></a><span class="at">&gt; **This code loads the r libraries necessary for this example**</span></span>
<span id="cb27-45"><a href="#cb27-45"></a></span>
<span id="cb27-46"><a href="#cb27-46"></a><span class="in">```{r pckg-load}</span></span>
<span id="cb27-47"><a href="#cb27-47"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-48"><a href="#cb27-48"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-49"><a href="#cb27-49"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-50"><a href="#cb27-50"></a><span class="co">#| class.source: fold-hide</span></span>
<span id="cb27-51"><a href="#cb27-51"></a></span>
<span id="cb27-52"><a href="#cb27-52"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb27-53"><a href="#cb27-53"></a></span>
<span id="cb27-54"><a href="#cb27-54"></a><span class="co">#Load packages</span></span>
<span id="cb27-55"><a href="#cb27-55"></a><span class="co">#library(lme4)</span></span>
<span id="cb27-56"><a href="#cb27-56"></a><span class="co">#library(lmerTest)</span></span>
<span id="cb27-57"><a href="#cb27-57"></a><span class="co">#library(tidyverse)</span></span>
<span id="cb27-58"><a href="#cb27-58"></a><span class="co">#library(afex)</span></span>
<span id="cb27-59"><a href="#cb27-59"></a><span class="co">#library(janitor)</span></span>
<span id="cb27-60"><a href="#cb27-60"></a><span class="co">#library(skimr)</span></span>
<span id="cb27-61"><a href="#cb27-61"></a><span class="co">#library(sdamr)</span></span>
<span id="cb27-62"><a href="#cb27-62"></a></span>
<span id="cb27-63"><a href="#cb27-63"></a><span class="fu">library</span>(lme4)</span>
<span id="cb27-64"><a href="#cb27-64"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb27-65"><a href="#cb27-65"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb27-66"><a href="#cb27-66"></a><span class="fu">library</span>(arrow)</span>
<span id="cb27-67"><a href="#cb27-67"></a><span class="fu">library</span>(afex)</span>
<span id="cb27-68"><a href="#cb27-68"></a><span class="fu">library</span>(janitor)</span>
<span id="cb27-69"><a href="#cb27-69"></a><span class="fu">library</span>(skimr)</span>
<span id="cb27-70"><a href="#cb27-70"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb27-71"><a href="#cb27-71"></a><span class="fu">library</span>(formatR)</span>
<span id="cb27-72"><a href="#cb27-72"></a><span class="fu">library</span>(report)</span>
<span id="cb27-73"><a href="#cb27-73"></a><span class="fu">library</span>(easystats)</span>
<span id="cb27-74"><a href="#cb27-74"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb27-75"><a href="#cb27-75"></a><span class="fu">library</span>(poorman)</span>
<span id="cb27-76"><a href="#cb27-76"></a><span class="fu">library</span>(parameters)</span>
<span id="cb27-77"><a href="#cb27-77"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb27-78"><a href="#cb27-78"></a><span class="fu">library</span>(DT)</span>
<span id="cb27-79"><a href="#cb27-79"></a><span class="fu">library</span>(data.table)</span>
<span id="cb27-80"><a href="#cb27-80"></a><span class="fu">library</span>(arsenal)</span>
<span id="cb27-81"><a href="#cb27-81"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb27-82"><a href="#cb27-82"></a><span class="fu">library</span>(equatiomatic)</span>
<span id="cb27-83"><a href="#cb27-83"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb27-84"><a href="#cb27-84"></a><span class="in">```</span></span>
<span id="cb27-85"><a href="#cb27-85"></a></span>
<span id="cb27-86"><a href="#cb27-86"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-87"><a href="#cb27-87"></a></span>
<span id="cb27-88"><a href="#cb27-88"></a><span class="fu">### Config Options</span></span>
<span id="cb27-89"><a href="#cb27-89"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-90"><a href="#cb27-90"></a></span>
<span id="cb27-91"><a href="#cb27-91"></a>**This code configures knitr code chunk options**</span>
<span id="cb27-92"><a href="#cb27-92"></a></span>
<span id="cb27-93"><a href="#cb27-93"></a><span class="in">```{r config}</span></span>
<span id="cb27-94"><a href="#cb27-94"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-95"><a href="#cb27-95"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-96"><a href="#cb27-96"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-97"><a href="#cb27-97"></a></span>
<span id="cb27-98"><a href="#cb27-98"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> T, <span class="at">message=</span>F, <span class="at">warning=</span>F, <span class="at">error=</span>F, </span>
<span id="cb27-99"><a href="#cb27-99"></a>                        <span class="at">comment=</span><span class="cn">NA</span>, <span class="at">cache=</span>T, <span class="at">code_folding=</span>T,</span>
<span id="cb27-100"><a href="#cb27-100"></a>                        <span class="at">R.options=</span><span class="fu">list</span>(<span class="at">width=</span><span class="dv">220</span>), <span class="at">fig.align=</span><span class="st">'center'</span>,</span>
<span id="cb27-101"><a href="#cb27-101"></a>                        <span class="at">out.width=</span><span class="st">'75%'</span>, <span class="at">fig.asp=</span>.<span class="dv">75</span>)</span>
<span id="cb27-102"><a href="#cb27-102"></a><span class="in">```</span></span>
<span id="cb27-103"><a href="#cb27-103"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-104"><a href="#cb27-104"></a>:::</span>
<span id="cb27-105"><a href="#cb27-105"></a></span>
<span id="cb27-106"><a href="#cb27-106"></a><span class="fu">## Descriptives Overview</span></span>
<span id="cb27-107"><a href="#cb27-107"></a>::: {.panel-tabset}</span>
<span id="cb27-108"><a href="#cb27-108"></a><span class="fu">### Read and View Data {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb27-109"><a href="#cb27-109"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-110"><a href="#cb27-110"></a></span>
<span id="cb27-111"><a href="#cb27-111"></a>**This code reads in and shows the data to be used in the current example**</span>
<span id="cb27-112"><a href="#cb27-112"></a></span>
<span id="cb27-113"><a href="#cb27-113"></a><span class="in">```{r read-data}</span></span>
<span id="cb27-114"><a href="#cb27-114"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-115"><a href="#cb27-115"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-116"><a href="#cb27-116"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-117"><a href="#cb27-117"></a></span>
<span id="cb27-118"><a href="#cb27-118"></a><span class="do">## Read data</span></span>
<span id="cb27-119"><a href="#cb27-119"></a>df_long<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/shawes/Desktop/data/df_long.csv"</span>)</span>
<span id="cb27-120"><a href="#cb27-120"></a><span class="co">#df_wide &lt;- read_csv("/path/to/datafile")</span></span>
<span id="cb27-121"><a href="#cb27-121"></a></span>
<span id="cb27-122"><a href="#cb27-122"></a><span class="co"># set types (if necessary)</span></span>
<span id="cb27-123"><a href="#cb27-123"></a><span class="co">#df_long$x &lt;- as.factor(df_long$x)</span></span>
<span id="cb27-124"><a href="#cb27-124"></a><span class="co">#df_long$y &lt;- as.numeric(df_long$y)</span></span>
<span id="cb27-125"><a href="#cb27-125"></a><span class="in">```</span></span>
<span id="cb27-126"><a href="#cb27-126"></a></span>
<span id="cb27-127"><a href="#cb27-127"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-128"><a href="#cb27-128"></a></span>
<span id="cb27-129"><a href="#cb27-129"></a><span class="fu">### Descriptives</span></span>
<span id="cb27-130"><a href="#cb27-130"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-131"><a href="#cb27-131"></a><span class="in">```{r descriptives}</span></span>
<span id="cb27-132"><a href="#cb27-132"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-133"><a href="#cb27-133"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-134"><a href="#cb27-134"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-135"><a href="#cb27-135"></a><span class="co">#| results: "asis"</span></span>
<span id="cb27-136"><a href="#cb27-136"></a></span>
<span id="cb27-137"><a href="#cb27-137"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb27-138"><a href="#cb27-138"></a>descriptives_1  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb27-139"><a href="#cb27-139"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb27-140"><a href="#cb27-140"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span> </span>
<span id="cb27-141"><a href="#cb27-141"></a>                                               ), <span class="co">#"Nmiss2"</span></span>
<span id="cb27-142"><a href="#cb27-142"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co">#"Nmiss2"</span></span>
<span id="cb27-143"><a href="#cb27-143"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb27-144"><a href="#cb27-144"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb27-145"><a href="#cb27-145"></a>                                                 )) <span class="co">#, Nmiss2 ='Missing'</span></span>
<span id="cb27-146"><a href="#cb27-146"></a></span>
<span id="cb27-147"><a href="#cb27-147"></a>my_cont_labels <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb27-148"><a href="#cb27-148"></a>  <span class="at">age =</span> <span class="st">"Age"</span>,</span>
<span id="cb27-149"><a href="#cb27-149"></a>  <span class="at">vg_total =</span> <span class="st">"Weekly # of Video Gaming Hrs"</span>,</span>
<span id="cb27-150"><a href="#cb27-150"></a>  <span class="at">cbcl_extern =</span> <span class="st">"CBCL Externalizing Scale"</span></span>
<span id="cb27-151"><a href="#cb27-151"></a>)</span>
<span id="cb27-152"><a href="#cb27-152"></a></span>
<span id="cb27-153"><a href="#cb27-153"></a>tab_descriptives_1 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> age <span class="sc">+</span> vg_total <span class="sc">+</span> </span>
<span id="cb27-154"><a href="#cb27-154"></a>                            cbcl_extern,</span>
<span id="cb27-155"><a href="#cb27-155"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_1)</span>
<span id="cb27-156"><a href="#cb27-156"></a></span>
<span id="cb27-157"><a href="#cb27-157"></a><span class="co">#summary(tab_descriptives_1, labelTranslations = my_cont_labels , text=TRUE, title = #"Continuous Outcomes", term.name = TRUE)</span></span>
<span id="cb27-158"><a href="#cb27-158"></a></span>
<span id="cb27-159"><a href="#cb27-159"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb27-160"><a href="#cb27-160"></a>tab_descriptives_1 <span class="sc">%&gt;%</span></span>
<span id="cb27-161"><a href="#cb27-161"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-162"><a href="#cb27-162"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Continuous Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-163"><a href="#cb27-163"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>,</span>
<span id="cb27-164"><a href="#cb27-164"></a>                <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb27-165"><a href="#cb27-165"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-166"><a href="#cb27-166"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-167"><a href="#cb27-167"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-168"><a href="#cb27-168"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-169"><a href="#cb27-169"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-170"><a href="#cb27-170"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-171"><a href="#cb27-171"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb27-172"><a href="#cb27-172"></a><span class="in">```</span></span>
<span id="cb27-173"><a href="#cb27-173"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-174"><a href="#cb27-174"></a></span>
<span id="cb27-175"><a href="#cb27-175"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-176"><a href="#cb27-176"></a><span class="in">```{r catvar-table}</span></span>
<span id="cb27-177"><a href="#cb27-177"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-178"><a href="#cb27-178"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-179"><a href="#cb27-179"></a><span class="co">#| results: "asis"</span></span>
<span id="cb27-180"><a href="#cb27-180"></a></span>
<span id="cb27-181"><a href="#cb27-181"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb27-182"><a href="#cb27-182"></a>descriptives_2  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb27-183"><a href="#cb27-183"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb27-184"><a href="#cb27-184"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span></span>
<span id="cb27-185"><a href="#cb27-185"></a>                                               ), <span class="co"># "Nmiss2"</span></span>
<span id="cb27-186"><a href="#cb27-186"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co"># "Nmiss2"</span></span>
<span id="cb27-187"><a href="#cb27-187"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb27-188"><a href="#cb27-188"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb27-189"><a href="#cb27-189"></a>                                                 )) <span class="co"># , Nmiss2 ='Missing'</span></span>
<span id="cb27-190"><a href="#cb27-190"></a></span>
<span id="cb27-191"><a href="#cb27-191"></a>my_cat_labels  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb27-192"><a href="#cb27-192"></a>  <span class="at">event =</span> <span class="st">"Year"</span>,</span>
<span id="cb27-193"><a href="#cb27-193"></a>  <span class="at">sex =</span> <span class="st">"Sex"</span>,</span>
<span id="cb27-194"><a href="#cb27-194"></a>  <span class="at">mature_vg =</span> <span class="st">"Mature Video Games"</span></span>
<span id="cb27-195"><a href="#cb27-195"></a>  )</span>
<span id="cb27-196"><a href="#cb27-196"></a></span>
<span id="cb27-197"><a href="#cb27-197"></a>tab_descriptives_2 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> sex <span class="sc">+</span> mature_vg, </span>
<span id="cb27-198"><a href="#cb27-198"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_2)</span>
<span id="cb27-199"><a href="#cb27-199"></a></span>
<span id="cb27-200"><a href="#cb27-200"></a><span class="co">#summary(tab_descriptives_2, labelTranslations = my_cat_labels , text=TRUE, title = #"Categorical Outcomes", term.name = TRUE)</span></span>
<span id="cb27-201"><a href="#cb27-201"></a></span>
<span id="cb27-202"><a href="#cb27-202"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb27-203"><a href="#cb27-203"></a>tab_descriptives_2 <span class="sc">%&gt;%</span></span>
<span id="cb27-204"><a href="#cb27-204"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-205"><a href="#cb27-205"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Categorical Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-206"><a href="#cb27-206"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb27-207"><a href="#cb27-207"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-208"><a href="#cb27-208"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-209"><a href="#cb27-209"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-210"><a href="#cb27-210"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-211"><a href="#cb27-211"></a>  <span class="co">#column_spec(3, width = "20em", border_right = T) %&gt;%</span></span>
<span id="cb27-212"><a href="#cb27-212"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-213"><a href="#cb27-213"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb27-214"><a href="#cb27-214"></a></span>
<span id="cb27-215"><a href="#cb27-215"></a><span class="in">```</span></span>
<span id="cb27-216"><a href="#cb27-216"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-217"><a href="#cb27-217"></a>:::</span>
<span id="cb27-218"><a href="#cb27-218"></a>  </span>
<span id="cb27-219"><a href="#cb27-219"></a><span class="fu">## Results</span></span>
<span id="cb27-220"><a href="#cb27-220"></a>    </span>
<span id="cb27-221"><a href="#cb27-221"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-222"><a href="#cb27-222"></a></span>
<span id="cb27-223"><a href="#cb27-223"></a>::: panel-tabset</span>
<span id="cb27-224"><a href="#cb27-224"></a><span class="fu">### Build Model {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb27-225"><a href="#cb27-225"></a>  </span>
<span id="cb27-226"><a href="#cb27-226"></a>::: blue</span>
<span id="cb27-227"><a href="#cb27-227"></a>  </span>
<span id="cb27-228"><a href="#cb27-228"></a>The code snippet below tells R to compute xxxxx by xxxxxxx. Next, xxxxx is conducted to examine whether xxxxxx does xxxxxxx (indicating xxxxx). The xxxx function (xxx) is provided by the r 'xxx' package.</span>
<span id="cb27-229"><a href="#cb27-229"></a>The code above is very similar to the code for the random intercept model, except that now we use the code (1 + Days \| Subject) to specify a random intercept for each Subject, and a random slope of Days for each Subject. This allows both the intercept and the slope of days to vary across participants.</span>
<span id="cb27-230"><a href="#cb27-230"></a></span>
<span id="cb27-231"><a href="#cb27-231"></a>**STEP 1: Compute xxxxxxxx**</span>
<span id="cb27-232"><a href="#cb27-232"></a><span class="in">```{r build-model-1}</span></span>
<span id="cb27-233"><a href="#cb27-233"></a><span class="co">#| class.source: 'fold-hide'</span></span>
<span id="cb27-234"><a href="#cb27-234"></a><span class="co">#| message: FALSE</span></span>
<span id="cb27-235"><a href="#cb27-235"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-236"><a href="#cb27-236"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-237"><a href="#cb27-237"></a></span>
<span id="cb27-238"><a href="#cb27-238"></a><span class="do">## Linear Mixed Model with a random intercept (LMM-ri)</span></span>
<span id="cb27-239"><a href="#cb27-239"></a><span class="co">#really still an intercept only model</span></span>
<span id="cb27-240"><a href="#cb27-240"></a>random_slopes <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> event <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ids), <span class="at">data =</span> df_long, <span class="at">REML=</span>F)</span>
<span id="cb27-241"><a href="#cb27-241"></a><span class="fu">print</span>(random_slopes)</span>
<span id="cb27-242"><a href="#cb27-242"></a></span>
<span id="cb27-243"><a href="#cb27-243"></a><span class="in">```</span></span>
<span id="cb27-244"><a href="#cb27-244"></a></span>
<span id="cb27-245"><a href="#cb27-245"></a><span class="in">```{r model-output}</span></span>
<span id="cb27-246"><a href="#cb27-246"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-247"><a href="#cb27-247"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-248"><a href="#cb27-248"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-249"><a href="#cb27-249"></a><span class="co">#| code-summary: testing</span></span>
<span id="cb27-250"><a href="#cb27-250"></a></span>
<span id="cb27-251"><a href="#cb27-251"></a><span class="fu">summary</span>(random_slopes)</span>
<span id="cb27-252"><a href="#cb27-252"></a></span>
<span id="cb27-253"><a href="#cb27-253"></a><span class="do">## Output and reports extending from the LMM-ri analyses</span></span>
<span id="cb27-254"><a href="#cb27-254"></a><span class="fu">summary</span>(random_slopes)</span>
<span id="cb27-255"><a href="#cb27-255"></a><span class="fu">confint</span>(random_slopes, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb27-256"><a href="#cb27-256"></a><span class="fu">report</span>(random_slopes)</span>
<span id="cb27-257"><a href="#cb27-257"></a><span class="fu">report_performance</span>(random_slopes)</span>
<span id="cb27-258"><a href="#cb27-258"></a><span class="fu">report_statistics</span>(random_slopes)</span>
<span id="cb27-259"><a href="#cb27-259"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_grouplevel</span>(random_slopes)</span>
<span id="cb27-260"><a href="#cb27-260"></a></span>
<span id="cb27-261"><a href="#cb27-261"></a><span class="in">```</span></span>
<span id="cb27-262"><a href="#cb27-262"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb27-263"><a href="#cb27-263"></a></span>
<span id="cb27-264"><a href="#cb27-264"></a>The summary function is used to print out the results from the random intercept model and</span>
<span id="cb27-265"><a href="#cb27-265"></a></span>
<span id="cb27-266"><a href="#cb27-266"></a>**STEP 2: Conduct xxxxxxx**</span>
<span id="cb27-267"><a href="#cb27-267"></a><span class="in">```{r build-model-2}</span></span>
<span id="cb27-268"><a href="#cb27-268"></a><span class="co">#| class.source: 'fold-hide'</span></span>
<span id="cb27-269"><a href="#cb27-269"></a><span class="co">#| message: FALSE</span></span>
<span id="cb27-270"><a href="#cb27-270"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-271"><a href="#cb27-271"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-272"><a href="#cb27-272"></a></span>
<span id="cb27-273"><a href="#cb27-273"></a><span class="do">## Obtain LMM-ri model parameters to plot/graph of results</span></span>
<span id="cb27-274"><a href="#cb27-274"></a><span class="do">## Fixed-Effects</span></span>
<span id="cb27-275"><a href="#cb27-275"></a>model_intercept <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">coef</span>(random_slopes)<span class="sc">$</span>ids[,<span class="dv">1</span>], <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb27-276"><a href="#cb27-276"></a>slopes2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">coef</span>(random_slopes)<span class="sc">$</span>ids[,<span class="dv">2</span>], <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb27-277"><a href="#cb27-277"></a><span class="co">#This code allows for extracting the fixed effects estimates for the model intercept and slope.</span></span>
<span id="cb27-278"><a href="#cb27-278"></a></span>
<span id="cb27-279"><a href="#cb27-279"></a><span class="in">```</span></span>
<span id="cb27-280"><a href="#cb27-280"></a></span>
<span id="cb27-281"><a href="#cb27-281"></a>The output from our model provides: i. a parameter estimate; ii. standard error; iii. p-value. In our example p = .001 which is less than .05 indicating significant differences in predicted cbcl externalizing scores between boys and girls in the ABCD Study. An examination of the regression coeefficient for sex (female = 0; male = 1) is b = .xx, indicating the difference in cbcl externalizing scores from Time 1 to Time 2 is significantly greater in boys taking part in the ABCD Study relative to girls. Then we conclude that participant sex (does/does not) predict change in cbcl externalizing scores from t1 to t2.</span>
<span id="cb27-282"><a href="#cb27-282"></a></span>
<span id="cb27-283"><a href="#cb27-283"></a>From the fixed effects section of the model summary, we can conclude that there is strong evidence that number of days of sleep deprivation significantly increased reaction time under a significance level of 0.05. On average, for each additional day of sleep deprivation, reaction time increased by 10.47ms (b = 10.47, SE = 1.55, p <span class="sc">\&lt;</span> .001).</span>
<span id="cb27-284"><a href="#cb27-284"></a></span>
<span id="cb27-285"><a href="#cb27-285"></a>We are 95% confident that the average increase was between 7.44 and 13.50.</span>
<span id="cb27-286"><a href="#cb27-286"></a></span>
<span id="cb27-287"><a href="#cb27-287"></a>From the fixed effects section, we estimated the average intercept and average effect of days of sleep deprivation (slopes of Days). We also estimated the corresponding 95% confidence intervals. Using the results from the random effects section, we can calculate the coverage intervals for both the intercept and the slope.</span>
<span id="cb27-288"><a href="#cb27-288"></a></span>
<span id="cb27-289"><a href="#cb27-289"></a>The variance of the intercept and for the slope of Days is 612.1 and 35.1 respectively. Taking their square root, the corresponding standard deviations are 24.7 and 5.9. The 95% coverage interval of the intercept is 251.4 Â± 1.96<span class="sc">\*</span>24.7. The lower bound is 203.0 and the upper bound is 299.8. It is therefore estimated that 95% of the participants had a reaction time between 203.0 and 299.8 at Day 0.</span>
<span id="cb27-290"><a href="#cb27-290"></a></span>
<span id="cb27-291"><a href="#cb27-291"></a>The 95% coverage interval of the slope of Days is 10.5 Â± 1.96<span class="sc">\*</span>5.9. The lower bound is -1.1 and the upper bound is 22.1. It is therefore estimated that for 95% of the participants, the effect of each additional day of sleep deprivation was between -1.1 and 22.1. This is not to be confused with the 95% confidence interval (7.4 and 13.5), which means that we are 95% confident that average effect (across all participants) of each additional day of sleep deprivation on reaction time was between 7.4 and 13.5. The model now estimates a variance of the random slopes effects, as well as a correlation between the random intercept and slope effects. :::</span>
<span id="cb27-292"><a href="#cb27-292"></a></span>
<span id="cb27-295"><a href="#cb27-295"></a><span class="in">```{r}</span></span>
<span id="cb27-296"><a href="#cb27-296"></a><span class="co">#| message: FALSE</span></span>
<span id="cb27-297"><a href="#cb27-297"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-298"><a href="#cb27-298"></a></span>
<span id="cb27-299"><a href="#cb27-299"></a><span class="co"># # ! THIS PLOT RUNS &amp; PRINTS TO SCREEN. I am temporarily commenting it out due to a side-effect of the </span></span>
<span id="cb27-300"><a href="#cb27-300"></a><span class="co"># #"intercepts2 variable"</span></span>
<span id="cb27-301"><a href="#cb27-301"></a><span class="co"># ggplot(df_long, aes(x = event, y = cbcl_extern)) + </span></span>
<span id="cb27-302"><a href="#cb27-302"></a><span class="co">#   geom_abline(model_slope = slopes2, model_intercept = intercepts2, </span></span>
<span id="cb27-303"><a href="#cb27-303"></a><span class="co">#               linetype = "solid", color = "black", linewidth = 1) + </span></span>
<span id="cb27-304"><a href="#cb27-304"></a><span class="co">#   # geom_abline(mapping = aes(slopes2 = model_slope, intercepts2 = model_intercept, linetype = PID), </span></span>
<span id="cb27-305"><a href="#cb27-305"></a><span class="co">#   #             linetype = "dashed", color = "grey70", linewidth = .4) +</span></span>
<span id="cb27-306"><a href="#cb27-306"></a><span class="co">#   #geom_point(aes(shape = ids), size = 3.25, color = "grey70") + </span></span>
<span id="cb27-307"><a href="#cb27-307"></a><span class="co">#   #scale_shape_manual() + </span></span>
<span id="cb27-308"><a href="#cb27-308"></a><span class="co">#   # geom_segment(aes(x = event, xend = event, </span></span>
<span id="cb27-309"><a href="#cb27-309"></a><span class="co">#   #                  y = cbcl1, yend = fitted(model_slope)), </span></span>
<span id="cb27-310"><a href="#cb27-310"></a><span class="co">#   #              color = "grey70") +</span></span>
<span id="cb27-311"><a href="#cb27-311"></a><span class="co">#   scale_y_continuous(expand = c(0, 0), breaks = c(0, 100, 200, 300, 400, 500), </span></span>
<span id="cb27-312"><a href="#cb27-312"></a><span class="co">#                      limits = c(0, 500)) +</span></span>
<span id="cb27-313"><a href="#cb27-313"></a><span class="co">#   scale_x_continuous(expand = c(0, 0), breaks = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9), </span></span>
<span id="cb27-314"><a href="#cb27-314"></a><span class="co">#                      limits = c(-0.5, 10.5)) +</span></span>
<span id="cb27-315"><a href="#cb27-315"></a><span class="co">#   theme(panel.background = element_blank(),         </span></span>
<span id="cb27-316"><a href="#cb27-316"></a><span class="co">#           panel.grid.major = element_blank(),</span></span>
<span id="cb27-317"><a href="#cb27-317"></a><span class="co">#             panel.grid.minor = element_blank(),</span></span>
<span id="cb27-318"><a href="#cb27-318"></a><span class="co">#             panel.border = element_rect(colour = "black", fill = NA),</span></span>
<span id="cb27-319"><a href="#cb27-319"></a><span class="co">#           legend.position = "none", </span></span>
<span id="cb27-320"><a href="#cb27-320"></a><span class="co">#           axis.text = element_text(size = 14),</span></span>
<span id="cb27-321"><a href="#cb27-321"></a><span class="co">#           axis.title = element_text(size = 14)) +</span></span>
<span id="cb27-322"><a href="#cb27-322"></a><span class="co">#     labs (x = "event", y = "cbcl_extern") </span></span>
<span id="cb27-323"><a href="#cb27-323"></a><span class="co">#   </span></span>
<span id="cb27-324"><a href="#cb27-324"></a><span class="co"># #Save the figure</span></span>
<span id="cb27-325"><a href="#cb27-325"></a><span class="co">#  ggsave("random_slopes.png", units = "in", width = 9, height = 6, dpi = 300)</span></span>
<span id="cb27-326"><a href="#cb27-326"></a><span class="in">```</span></span>
<span id="cb27-327"><a href="#cb27-327"></a>  </span>
<span id="cb27-328"><a href="#cb27-328"></a><span class="fu">###   Model Plots</span></span>
<span id="cb27-329"><a href="#cb27-329"></a>    </span>
<span id="cb27-330"><a href="#cb27-330"></a>:::blue</span>
<span id="cb27-331"><a href="#cb27-331"></a></span>
<span id="cb27-332"><a href="#cb27-332"></a><span class="in">```{r diag-plots}</span></span>
<span id="cb27-333"><a href="#cb27-333"></a><span class="co"># #| messages: FALSE</span></span>
<span id="cb27-334"><a href="#cb27-334"></a><span class="co"># #| warning: FALSE</span></span>
<span id="cb27-335"><a href="#cb27-335"></a><span class="co"># #| echo: FALSE</span></span>
<span id="cb27-336"><a href="#cb27-336"></a><span class="co"># #| column: screen-inset-shaded</span></span>
<span id="cb27-337"><a href="#cb27-337"></a><span class="co"># #| layout-nrow: 2</span></span>
<span id="cb27-338"><a href="#cb27-338"></a><span class="co">#     </span></span>
<span id="cb27-339"><a href="#cb27-339"></a><span class="co"># ## xxxxx plot</span></span>
<span id="cb27-340"><a href="#cb27-340"></a><span class="co"># random_intercepts.std &lt;- resid(model_intercept)/sd(resid(model_intercept))</span></span>
<span id="cb27-341"><a href="#cb27-341"></a><span class="co"># plot (random_intercepts.std, ylab="Standardized Residuals")</span></span>
<span id="cb27-342"><a href="#cb27-342"></a><span class="co"># </span></span>
<span id="cb27-343"><a href="#cb27-343"></a><span class="co"># ## Outlier Tests. </span></span>
<span id="cb27-344"><a href="#cb27-344"></a><span class="co"># #car::outlierTest(random_intercepts)</span></span>
<span id="cb27-345"><a href="#cb27-345"></a><span class="co"># car::infIndexPlot(random_intercepts)</span></span>
<span id="cb27-346"><a href="#cb27-346"></a><span class="co"># </span></span>
<span id="cb27-347"><a href="#cb27-347"></a><span class="co"># ## qqplot</span></span>
<span id="cb27-348"><a href="#cb27-348"></a><span class="co"># ggplot(as.data.frame(random_intercepts.std), aes(sample = random_intercepts.std)) +</span></span>
<span id="cb27-349"><a href="#cb27-349"></a><span class="co">#   geom_qq() +</span></span>
<span id="cb27-350"><a href="#cb27-350"></a><span class="co">#   geom_qq_line()</span></span>
<span id="cb27-351"><a href="#cb27-351"></a><span class="co"># </span></span>
<span id="cb27-352"><a href="#cb27-352"></a><span class="co"># ## Predicted vs Actual plot</span></span>
<span id="cb27-353"><a href="#cb27-353"></a><span class="co"># predicted &lt;- estimate_expectation(random_intercepts, data = "grid")</span></span>
<span id="cb27-354"><a href="#cb27-354"></a><span class="co"># plot(predicted)</span></span>
<span id="cb27-355"><a href="#cb27-355"></a><span class="co"># </span></span>
<span id="cb27-356"><a href="#cb27-356"></a><span class="co"># ## Estimated means plot</span></span>
<span id="cb27-357"><a href="#cb27-357"></a><span class="co"># means &lt;- estimate_means(random_intercepts)</span></span>
<span id="cb27-358"><a href="#cb27-358"></a><span class="co"># plot(means)</span></span>
<span id="cb27-359"><a href="#cb27-359"></a></span>
<span id="cb27-360"><a href="#cb27-360"></a><span class="in">```</span></span>
<span id="cb27-361"><a href="#cb27-361"></a></span>
<span id="cb27-362"><a href="#cb27-362"></a>#Build diagnostic plots. Observations with a Bonferroni p <span class="sc">\&lt;</span> .05 might</span>
<span id="cb27-363"><a href="#cb27-363"></a>#be considered as outliers and might need further investigation.</span>
<span id="cb27-364"><a href="#cb27-364"></a>Examination of this scatterplot indicates xxxxx.</span>
<span id="cb27-365"><a href="#cb27-365"></a></span>
<span id="cb27-366"><a href="#cb27-366"></a><span class="in">```{r barplot}</span></span>
<span id="cb27-367"><a href="#cb27-367"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-368"><a href="#cb27-368"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-369"><a href="#cb27-369"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-370"><a href="#cb27-370"></a></span>
<span id="cb27-371"><a href="#cb27-371"></a><span class="co"># Basic ggplot2 barplot with mean</span></span>
<span id="cb27-372"><a href="#cb27-372"></a>p <span class="ot">&lt;-</span>df_long <span class="sc">%&gt;%</span></span>
<span id="cb27-373"><a href="#cb27-373"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(event)) <span class="sc">%&gt;%</span> <span class="co"># filter on non-missing values  </span></span>
<span id="cb27-374"><a href="#cb27-374"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> cbcl_extern, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb27-375"><a href="#cb27-375"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb27-376"><a href="#cb27-376"></a>           <span class="at">stat =</span> <span class="st">"summary"</span>,</span>
<span id="cb27-377"><a href="#cb27-377"></a>           <span class="at">fun =</span> <span class="st">"mean"</span>,</span>
<span id="cb27-378"><a href="#cb27-378"></a>           <span class="co">#fill = "#AA4A44",</span></span>
<span id="cb27-379"><a href="#cb27-379"></a>           <span class="co">#color = "#0099f9"</span></span>
<span id="cb27-380"><a href="#cb27-380"></a>           ) <span class="sc">+</span></span>
<span id="cb27-381"><a href="#cb27-381"></a>    <span class="co">#scale_fill_brewer(palette = "Set1") +</span></span>
<span id="cb27-382"><a href="#cb27-382"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3db5ff"</span>, <span class="st">"#0099f9"</span>)) <span class="sc">+</span></span>
<span id="cb27-383"><a href="#cb27-383"></a>    <span class="co">#scale_fill_gradient(high = "#B00B69", low = "#0e0e63") +</span></span>
<span id="cb27-384"><a href="#cb27-384"></a>    <span class="co">#geom_text(aes(label = cu_traits), position = position_dodge(0.9), </span></span>
<span id="cb27-385"><a href="#cb27-385"></a>              <span class="co">#vjust = 2, size = 4, color = "#ffffff") +</span></span>
<span id="cb27-386"><a href="#cb27-386"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Behavior Problems by Video Game Groups"</span>, <span class="at">subtitle =</span> <span class="st">"Simple bar chart"</span>,</span>
<span id="cb27-387"><a href="#cb27-387"></a>         <span class="at">caption =</span> <span class="st">"Simple caption"</span>, <span class="at">x =</span> <span class="st">"DBD Group"</span>, <span class="at">y =</span> <span class="st">"CBCL Externalizing"</span>) <span class="sc">+</span></span>
<span id="cb27-388"><a href="#cb27-388"></a>              <span class="co">#coord_flip() +</span></span>
<span id="cb27-389"><a href="#cb27-389"></a>    <span class="co">#geom_hline(yintercept = mean(df$cbcl_agg), linetype = "dashed", size = 1) +</span></span>
<span id="cb27-390"><a href="#cb27-390"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-391"><a href="#cb27-391"></a>    <span class="fu">theme</span>(</span>
<span id="cb27-392"><a href="#cb27-392"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-393"><a href="#cb27-393"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb27-394"><a href="#cb27-394"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb27-395"><a href="#cb27-395"></a>            <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb27-396"><a href="#cb27-396"></a>            <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb27-397"><a href="#cb27-397"></a>    )</span>
<span id="cb27-398"><a href="#cb27-398"></a><span class="in">```</span></span>
<span id="cb27-399"><a href="#cb27-399"></a></span>
<span id="cb27-400"><a href="#cb27-400"></a>Examination of this scatterplot indicates xxxxx.</span>
<span id="cb27-401"><a href="#cb27-401"></a>    </span>
<span id="cb27-402"><a href="#cb27-402"></a><span class="in">```{r lmmri-graph}</span></span>
<span id="cb27-403"><a href="#cb27-403"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb27-404"><a href="#cb27-404"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb27-405"><a href="#cb27-405"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb27-406"><a href="#cb27-406"></a><span class="co">#| label: my-figure</span></span>
<span id="cb27-407"><a href="#cb27-407"></a><span class="co">#| fig-asp: 0.61</span></span>
<span id="cb27-408"><a href="#cb27-408"></a>  </span>
<span id="cb27-409"><a href="#cb27-409"></a><span class="co">#Random Intercept LMM Plot/Graph</span></span>
<span id="cb27-410"><a href="#cb27-410"></a><span class="co">#random_intercepts &lt;- lmer(Externalizing ~ 1 + Event + DBD + Sex + (1|ids), data = df, #REML=T)</span></span>
<span id="cb27-411"><a href="#cb27-411"></a></span>
<span id="cb27-412"><a href="#cb27-412"></a><span class="do">##  LMM-ri plot of estimated random intercepts </span></span>
<span id="cb27-413"><a href="#cb27-413"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> mature_vg <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> sex), <span class="at">data =</span> df_long)</span>
<span id="cb27-414"><a href="#cb27-414"></a>preds <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model, <span class="at">include_random =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-415"><a href="#cb27-415"></a>    </span>
<span id="cb27-416"><a href="#cb27-416"></a><span class="do">## Adding fixed effect trajectory to LMM-ri plot </span></span>
<span id="cb27-417"><a href="#cb27-417"></a>fixed_pred <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model) <span class="co"># This time, include_random is FALSE (default)</span></span>
<span id="cb27-418"><a href="#cb27-418"></a> <span class="fu">plot</span>(preds, <span class="at">ribbon =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># Previous plot</span></span>
<span id="cb27-419"><a href="#cb27-419"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">ymin =</span> CI_low, <span class="at">ymax =</span> CI_high), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb27-420"><a href="#cb27-420"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> Predicted), <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb27-421"><a href="#cb27-421"></a></span>
<span id="cb27-422"><a href="#cb27-422"></a><span class="co"># ggplot(df_long_sub, aes(x = event, y = cbcl_agg, color=sex, shape=sex)) + </span></span>
<span id="cb27-423"><a href="#cb27-423"></a><span class="co"># geom_abline(slope = model_slope, intercept = model_intercept, linetype = "solid", color = "red", linewidth = 1) + </span></span>
<span id="cb27-424"><a href="#cb27-424"></a><span class="co"># geom_point(color = "grey70") + </span></span>
<span id="cb27-425"><a href="#cb27-425"></a><span class="co"># geom_smooth(method=lm, se=FALSE, fullrange=TRUE)+</span></span>
<span id="cb27-426"><a href="#cb27-426"></a><span class="co"># scale_shape() + </span></span>
<span id="cb27-427"><a href="#cb27-427"></a><span class="co"># geom_segment(aes(x = event, xend = event, y = cbcl_agg, yend = fitted(cbcl_agg)), color = "grey70") + </span></span>
<span id="cb27-428"><a href="#cb27-428"></a><span class="co"># scale_y_continuous(expand = c(0, 0), breaks = c(0, 20, 40, 60, 80, 100), limits = c(0, 100)) + </span></span>
<span id="cb27-429"><a href="#cb27-429"></a><span class="co"># scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4), limits = c(0, 4)) +</span></span>
<span id="cb27-430"><a href="#cb27-430"></a><span class="co"># theme(panel.background = element_blank(),         </span></span>
<span id="cb27-431"><a href="#cb27-431"></a><span class="co">#         panel.grid.major = element_blank(),</span></span>
<span id="cb27-432"><a href="#cb27-432"></a><span class="co">#         panel.grid.minor = element_blank(),</span></span>
<span id="cb27-433"><a href="#cb27-433"></a><span class="co">#         panel.border = element_rect(colour = "black", fill = NA),</span></span>
<span id="cb27-434"><a href="#cb27-434"></a><span class="co">#         legend.position = "none",</span></span>
<span id="cb27-435"><a href="#cb27-435"></a><span class="co">#         axis.text = element_text(size = 14), </span></span>
<span id="cb27-436"><a href="#cb27-436"></a><span class="co">#         axis.title = element_text(size = 14)) +</span></span>
<span id="cb27-437"><a href="#cb27-437"></a><span class="co">#         labs (x = "Event", y= "CBCL Aggression")</span></span>
<span id="cb27-438"><a href="#cb27-438"></a></span>
<span id="cb27-439"><a href="#cb27-439"></a><span class="co">#Save the plot</span></span>
<span id="cb27-440"><a href="#cb27-440"></a><span class="co">#ggsave("random_intercept.png", units = "in", width = 9, height = 6, dpi = 300)  </span></span>
<span id="cb27-441"><a href="#cb27-441"></a></span>
<span id="cb27-442"><a href="#cb27-442"></a><span class="in">```</span></span>
<span id="cb27-443"><a href="#cb27-443"></a>  </span>
<span id="cb27-444"><a href="#cb27-444"></a><span class="kw">&lt;p</span> <span class="er">class</span><span class="ot">=</span><span class="st">"text-center"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"background-color: gray"</span><span class="kw">&gt;</span>Figure x: The overall group-mean (fixed effects) trajectory is shown in blue. The faded lines represent each individual youth's estimated trajectory. An examination of this figure shows happiness scores to be increasing across measurement occasions, however, there appears to be substantial variability in the youth's initial happiness scores.<span class="kw">&lt;/p&gt;</span></span>
<span id="cb27-445"><a href="#cb27-445"></a></span>
<span id="cb27-446"><a href="#cb27-446"></a>Examination of this barplot indicates xxxxx.</span>
<span id="cb27-447"><a href="#cb27-447"></a></span>
<span id="cb27-448"><a href="#cb27-448"></a><span class="fu">## Wrapping Up</span></span>
<span id="cb27-449"><a href="#cb27-449"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-450"><a href="#cb27-450"></a></span>
<span id="cb27-451"><a href="#cb27-451"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb27-452"><a href="#cb27-452"></a></span>
<span id="cb27-453"><a href="#cb27-453"></a>::: panel-tabset</span>
<span id="cb27-454"><a href="#cb27-454"></a><span class="fu">### Write-up {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb27-455"><a href="#cb27-455"></a></span>
<span id="cb27-456"><a href="#cb27-456"></a>::: blue</span>
<span id="cb27-457"><a href="#cb27-457"></a></span>
<span id="cb27-458"><a href="#cb27-458"></a>A random slope model is used to test if sleep deprivation affects reaction time. To account for the repeated measures design, a random intercept was specified for participants. The random slope for days of sleep deprivation was included in the model to allow the effect of sleep deprivation to vary across participants. Results are shown in Table 1. Using a significant level of 0.05, results indicate that sleep deprivation significantly increased reaction time. On average, each additional day of sleep deprivation increased reaction time by 10.47ms (b = 10.47, 95% CI = <span class="sc">\[</span>7.44, 13.50<span class="sc">\]</span>, p <span class="sc">\&lt;</span> .001). Model fit comparison between model with and without random slope for sleep deprivation shows that the effect of sleep deprivation varied across participants, Ï‡2(2)= 42.14, p <span class="sc">\&lt;</span> .001. The 95% coverage interval for the random slope of sleep deprivation is (-1.14, 22.07), indicating that the effect of sleep deprivation was between -1.14 and 22.07 for 95% of the participants.</span>
<span id="cb27-459"><a href="#cb27-459"></a>:::</span>
<span id="cb27-460"><a href="#cb27-460"></a></span>
<span id="cb27-461"><a href="#cb27-461"></a><span class="fu">## References</span></span>
<span id="cb27-462"><a href="#cb27-462"></a></span>
<span id="cb27-463"><a href="#cb27-463"></a><span class="co">[</span><span class="ot">@brown2021</span><span class="co">]</span> <span class="co">&lt;!-- [@Singmann2019]</span></span>
<span id="cb27-464"><a href="#cb27-464"></a><span class="co">[@sarafian]</span></span>
<span id="cb27-465"><a href="#cb27-465"></a><span class="co">[#@https://m-clark.github.io/]</span></span>
<span id="cb27-466"><a href="#cb27-466"></a><span class="co">[#@Fitzmaurice]</span></span>
<span id="cb27-467"><a href="#cb27-467"></a><span class="co">[#@mspeekenbrink.github.io]</span></span>
<span id="cb27-468"><a href="#cb27-468"></a><span class="co">[#https://cran.r-project.org/web/packages/lme4/lme4.pdf] --&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./refernce.qmd">Longitudinal Analysis</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>