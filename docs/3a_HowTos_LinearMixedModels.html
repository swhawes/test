<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.333">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Biostatistics Working Group">

<title>Longitudinal Analysis - Linear Mixed Models: Random Intercept</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4_HowTos_SignedRankTest.html" rel="next">
<link href="./2_HowTos_ResidualizedChangeScores.html" rel="prev">
<link href="././figures/lights.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>

<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.27/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/dt-ext-autofill-1.12.1/css/autoFill.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-autofill-1.12.1/js/dataTables.autoFill.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Longitudinal Analysis - Linear Mixed Models: Random Intercept">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://swhawes.github.io/test/3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-1.png">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Longitudinal Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./test.html" rel="" target="">
 <span class="menu-text">Manuscript</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./tutorials.html" rel="" target="">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./howto.html" rel="" target="">
 <span class="menu-text">How-To</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./explanations.html" rel="" target="">
 <span class="menu-text">Explanations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./reference.html" rel="" target="">
 <span class="menu-text">Reference</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://twitter.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/swhawes/test">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/swhawes/test/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1a_HowTos_DifferenceScores.html">Traditional Linear Models</a></li><li class="breadcrumb-item"><a href="./3a_HowTos_LinearMixedModels.html">Linear Mixed Models: Random Intercept</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="././figures/lights.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://twitter.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/swhawes/test">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/swhawes/test/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./howto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How-Toâ€™s: A Brief Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Traditional Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1a_HowTos_DifferenceScores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference Scores: Paired Samples T-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1b_HowTos_DifferenceScores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference Scores: Simple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_HowTos_ResidualizedChangeScores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Residualized Change Scores</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3a_HowTos_LinearMixedModels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Linear Mixed Models: Random Intercept</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Traditional Non-linear Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_HowTos_SignedRankTest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Signed-Rank Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_HowTos_MarginalModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Marginal Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_HowTos_GeneralizedEstimatingEquations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Estimating Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_HowTos_GeneralizedLinearMixedEffectsModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Linear Mixed Effects Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">SEM Approaches</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_HowTos_AutoregressiveCrosslaggedPanelModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autoregressive Crosslagged Panel Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_HowTos_LatentChangeScoresModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Change Score Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_HowTos_LatentGrowthCurveModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_HowTos_MultivariateLatentGrowthCurveModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate Latent Growth Curve Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_HowTos_LatentTransitionAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Transition Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_HowTos_GrowthMixtureModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Growth Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_HowTos_StateTraitModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">State-Trait Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Advanced SEM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_HowTos_RandomInterceptCrosslaggedPanelModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random-Intercept Crosslagged Panel Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_HowTos_LatentCurveModelsStructuredResiduals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Curve Models with Structured Residuals</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Longitudinal Neuroimaging</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blank Test Page</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Twin Modeling &amp; Genetics Designs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blank Test Page</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Linear Mixed Models: Random Intercept</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Biostatistics Working Group </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="linear-mixed-model-with-a-random-intercept-lmmri" class="level2">
<h2 class="anchored" data-anchor-id="linear-mixed-model-with-a-random-intercept-lmmri">Linear Mixed Model with a Random-Intercept (LMM:ri)</h2>
<p>
</p><p>The LMM:ri is similar to traditional (fixed-effect) linear regression extending on this approach by including a subject-specific random-effect that allows each participant to have their own unique intercept value, in addition to the overall mean-level (fixed-effect) intercept value zzzzt</p>
In this example, we will use the LMM:ri to analyze trajectories of scores on the externalizing subscale of the child behavior checklist (CBCL) obtained across three measurement occasions in a sample of youth taking part in the ABCD Study. Our primary aim is to characterize stability and change in CBCL externalizing scores across assessments, while accounting for observations that are clustered within youth over time. To do so, we will use the LMM:ri to simultaneously model an overall sample mean trajectory (fixed effect) and subject-specific (random) effects that vary randomly about the sample mean trajectory.
<p></p>
</section>
<section id="preliminary-setup" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-setup">Preliminary Setup</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Load Libraries</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Load Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Config Options</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
example-text before code block
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/pckg-install_3d220ea7ddb52bb367ebf778b371877d">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="do">## Install necessary packages (if not already installed)</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"lme4"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"lme4"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"lmerTest"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"lmerTest"</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"tidyverse"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"arrow"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"arrow"</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"afex"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"afex"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"janitor"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"janitor"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"skimr"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"skimr"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"sdamr"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"sdamr"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"formatR"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"formatR"</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"report"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"easystats"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"easystats"</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"emmeans"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"emmeans"</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"poorman"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"poorman"</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"parameters"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"parameters"</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"modelbased"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"modelbased"</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"DT"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"DT"</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"data.table"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"data.table"</span>)</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"arsenal"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"arsenal"</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"kableExtra"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"equatiomatic"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"equatiomatic"</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"gtsummary"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p>example-text after code block</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/pckg-load_76ec1c2d1456e81345790512a1bd3445">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r fold-hide number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="do">## Load packages</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(arrow)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(afex)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(janitor)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="fu">library</span>(skimr)</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="fu">library</span>(formatR)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="fu">library</span>(report)</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="fu">library</span>(easystats)</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="fu">library</span>(poorman)</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="fu">library</span>(parameters)</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="fu">library</span>(DT)</span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="fu">library</span>(data.table)</span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="fu">library</span>(arsenal)</span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="fu">library</span>(equatiomatic)</span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/config_143caef3d17445b318b3fd6abc3601bf">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> T, <span class="at">message=</span>F, <span class="at">warning=</span>F, <span class="at">error=</span>F, </span>
<span id="cb3-2"><a href="#cb3-2"></a>                      <span class="at">comment=</span><span class="cn">NA</span>, <span class="at">cache=</span>T, <span class="at">code_folding=</span>T,</span>
<span id="cb3-3"><a href="#cb3-3"></a>                      <span class="at">R.options=</span><span class="fu">list</span>(<span class="at">width=</span><span class="dv">220</span>), <span class="at">fig.align=</span><span class="st">'center'</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                      <span class="at">out.width=</span><span class="st">'75%'</span>, <span class="at">fig.asp=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="descriptives-overview" class="level2">
<h2 class="anchored" data-anchor-id="descriptives-overview">Descriptives Overview</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Data Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Descriptives</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/data-table_2993f0db12bfa8dbfde8e6fadabfad7d">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>df_long<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/shawes/Desktop/data/df_long.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#df_long_sub&lt;- read_csv("/Users/shawes/Desktop/df_long_sub.csv")</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="do">## Create a viewable 'datatable' of the primary dataframe (df)</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="fu">datatable</span>(<span class="fu">head</span>(df_long, <span class="dv">50</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>),<span class="at">extensions =</span> <span class="st">'AutoFill'</span>,<span class="st">'ColReorder'</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">autoFill =</span> <span class="cn">TRUE</span>,<span class="at">colReorder =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-center'</span>, <span class="at">targets =</span> <span class="dv">10</span>)),</span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="at">order =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">3</span>, <span class="st">'asc'</span>), <span class="fu">list</span>(<span class="dv">4</span>, <span class="st">'desc'</span>)),</span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="at">lengthMenu =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="st">"$(this.api().table().header()).css({'background-color': '#808080', 'color': '#fff'});"</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="st">"}"</span>)</span>
<span id="cb4-14"><a href="#cb4-14"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-86b5f064f8a094eeb9cc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-86b5f064f8a094eeb9cc">{"x":{"filter":"none","vertical":false,"extensions":["AutoFill"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],[1,1,1,2,2,2,3,4,4,4,5,5,5,6,6,6,7,7,8,8,8,9,9,9,10,10,11,11,11,12,12,12,13,13,14,14,14,15,15,15,16,16,16,17,17,17,18,19,20,20],["Year_1","Baseline","Year_2","Year_2","Year_1","Baseline","Baseline","Year_1","Year_2","Baseline","Year_2","Baseline","Year_1","Year_1","Baseline","Year_2","Baseline","Year_1","Baseline","Year_2","Year_1","Year_2","Baseline","Year_1","Year_1","Baseline","Baseline","Year_1","Year_2","Year_2","Baseline","Year_1","Baseline","Year_1","Year_1","Year_2","Baseline","Year_1","Baseline","Year_2","Year_1","Baseline","Year_2","Baseline","Year_2","Year_1","Baseline","Year_2","Baseline","Year_2"],["site061","site061","site061","site101","site101","site101","site22","site071","site071","site071","site20","site20","site20","site12","site12","site12","site17","site17","site03","site03","site03","site11","site11","site11","site17","site17","site06","site06","site06","site04","site04","site04","site12","site12","site14","site14","site14","site12","site12","site12","site17","site17","site17","site06","site06","site06","site04","site04","site19","site19"],[7731,7731,7731,9160,9160,9160,3672,2760,2760,2760,4305,4305,4305,1207,1207,1207,3101,3101,5019,5019,5019,7265,7265,7265,3102,3102,7730,7730,7730,1414,1414,1414,811,811,2642,2642,2642,812,812,812,3103,3103,3103,7732,7732,7732,1416,1416,6011,6011],["Female","Female","Female","Female","Female","Female","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Male","Male","Male","Male","Female","Female","Female","Male","Male","Female","Female"],[9,10,9,9,9,10,10,10,10,9,9,9,9,9,9,10,9,9,9,10,10,10,10,9,9,9,9,10,10,10,10,10,9,9,9,9,10,10,10,10,10,10,10,10,9,9,9,9,9,10],[37,1,0,1,0,0,0,1,1,0,1,1,0,0,0,3,1,0,1,1,3,3,3,3,0,0,0,0,1,0,0,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,3,2,0,0],[1,1,13,0,3,0,2,2,19,3,25,18,22,10,7,14,1,8,2,3,2,11,20,12,3,3,5,5,12,12,21,25,2,0,0,2,0,6,12,6,0,0,0,7,15,10,2,2,0,7],[7,7,7,7,3,0,4,4,5,2,2,7,9,28,1,1,4,2,11,11,11,11,28,4,26,6,3,3,3,3,28,3,23,16,6,8,6,2,5,3,7,4,5,2,6,7,28,6,11,7]],"container":"<table class=\"ColReorder\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ids<\/th>\n      <th>event<\/th>\n      <th>site_id<\/th>\n      <th>fam_id<\/th>\n      <th>sex<\/th>\n      <th>age<\/th>\n      <th>mature_vg<\/th>\n      <th>cbcl_extern<\/th>\n      <th>vg_total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"autoFill":true,"colReorder":true,"columnDefs":[{"className":"dt-center","targets":10},{"className":"dt-right","targets":[1,4,6,7,8,9]},{"orderable":false,"targets":0}],"order":[[3,"asc"],[4,"desc"]],"pageLength":10,"lengthMenu":[10,15,20],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#808080', 'color': '#fff'});\n}","autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="do">## Not run: </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Specify table size by pixels</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#kable(cbind(df_long, df_long), "html") %&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#    kable_styling() %&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#    scroll_box(width = "100%", height = "500px")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/descriptives_0faa4459e7fd99d3eb20a2bb477a8edd">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb6-2"><a href="#cb6-2"></a>descriptives_1  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>                                               ), <span class="co">#"Nmiss2"</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co">#"Nmiss2"</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb6-8"><a href="#cb6-8"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>                                                 )) <span class="co">#, Nmiss2 ='Missing'</span></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a>my_cont_labels <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="at">age =</span> <span class="st">"Age"</span>,</span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="at">vg_total =</span> <span class="st">"Weekly # of Video Gaming Hrs"</span>,</span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="at">cbcl_extern =</span> <span class="st">"CBCL Externalizing Scale"</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>)</span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a>tab_descriptives_1 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> age <span class="sc">+</span> vg_total <span class="sc">+</span> </span>
<span id="cb6-18"><a href="#cb6-18"></a>                            cbcl_extern,</span>
<span id="cb6-19"><a href="#cb6-19"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_1)</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#summary(tab_descriptives_1, labelTranslations = my_cont_labels , text=TRUE, title = #"Continuous Outcomes", term.name = TRUE)</span></span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>tab_descriptives_1 <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Continuous Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>,</span>
<span id="cb6-28"><a href="#cb6-28"></a>                <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb6-29"><a href="#cb6-29"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb6-33"><a href="#cb6-33"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb6-34"><a href="#cb6-34"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-35"><a href="#cb6-35"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:75%; ">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<caption>Continuous Outcomes</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Baseline (N=35)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_1 (N=34)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_2 (N=30)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">age</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">34</td>
<td style="text-align: left; vertical-align: middle !important;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">9.3 (0.5)</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">9.5 (0.5)</td>
<td style="text-align: left; vertical-align: middle !important;">9.6 (0.5)</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.5</td>
<td style="text-align: left;">10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.0 - 10.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">9.0 - 10.0</td>
<td style="text-align: left;">9.0 - 10.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">vg_total</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">34</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">8.7 (8.4)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">8.7 (8.1)</td>
<td style="text-align: left;">6.8 (4.3)</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">6.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">7.0</td>
<td style="text-align: left;">7.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 28.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 28.0</td>
<td style="text-align: left;">1.0 - 16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">cbcl_extern</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">34</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">4.8 (5.7)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">5.5 (6.1)</td>
<td style="text-align: left;">6.9 (6.9)</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">3.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">4.0</td>
<td style="text-align: left;">4.5</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 21.0</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 25.0</td>
<td style="text-align: left;">0.0 - 25.0</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Here is a general comments of the table.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>
</div>

</div>
</div>
</div>
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/catvar-table_082255a367ca20db4014ba18ce75231b">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb7-2"><a href="#cb7-2"></a>descriptives_2  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>                                               ), <span class="co"># "Nmiss2"</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co"># "Nmiss2"</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb7-8"><a href="#cb7-8"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>                                                 )) <span class="co"># , Nmiss2 ='Missing'</span></span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>my_cat_labels  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="at">event =</span> <span class="st">"Year"</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="at">sex =</span> <span class="st">"Sex"</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>  <span class="at">mature_vg =</span> <span class="st">"Mature Video Games"</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>  )</span>
<span id="cb7-16"><a href="#cb7-16"></a></span>
<span id="cb7-17"><a href="#cb7-17"></a>tab_descriptives_2 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> sex <span class="sc">+</span> mature_vg, </span>
<span id="cb7-18"><a href="#cb7-18"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_2)</span>
<span id="cb7-19"><a href="#cb7-19"></a></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#summary(tab_descriptives_2, labelTranslations = my_cat_labels , text=TRUE, title = #"Categorical Outcomes", term.name = TRUE)</span></span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>tab_descriptives_2 <span class="sc">%&gt;%</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Categorical Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb7-27"><a href="#cb7-27"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb7-30"><a href="#cb7-30"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb7-31"><a href="#cb7-31"></a>  <span class="co">#column_spec(3, width = "20em", border_right = T) %&gt;%</span></span>
<span id="cb7-32"><a href="#cb7-32"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:75%; ">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<caption>Categorical Outcomes</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Baseline (N=35)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_1 (N=34)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; position: sticky; top: 0; background-color: #FFFFFF;">Year_2 (N=30)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">sex</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Female</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">19 (54.3%)</td>
<td style="text-align: left; vertical-align: middle !important;">20 (58.8%)</td>
<td style="text-align: left; vertical-align: middle !important;">17 (56.7%)</td>
</tr>
<tr class="odd">
<td style="text-align: left; vertical-align: middle !important; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Male</td>
<td style="text-align: left; vertical-align: middle !important; width: 20em; border-right: 1px solid;">16 (45.7%)</td>
<td style="text-align: left; vertical-align: middle !important;">14 (41.2%)</td>
<td style="text-align: left; vertical-align: middle !important;">13 (43.3%)</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">mature_vg</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Count</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">35</td>
<td style="text-align: left;">34</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Mean (SD)</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.6 (0.9)</td>
<td style="text-align: left;">1.7 (6.3)</td>
<td style="text-align: left;">0.6 (0.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Median</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0</td>
<td style="text-align: left;">0.0</td>
<td style="text-align: left;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em; font-weight: bold; background-color: light grey !important; border-right: 1px solid;">- Min - Max</td>
<td style="text-align: left; width: 20em; border-right: 1px solid;">0.0 - 3.0</td>
<td style="text-align: left;">0.0 - 37.0</td>
<td style="text-align: left;">0.0 - 3.0</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Here is a general comments of the table.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>
</div>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Build Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Model Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Model Report</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/build-model_3018a27d75b75f44a0be379334c9698f">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="do">## Linear Mixed Model with a random intercept (LMM-ri)</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>random_intercepts <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> event <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ids), <span class="at">data =</span> df_long, <span class="at">REML=</span>T)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="fu">print</span>(random_intercepts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerModLmerTest']
Formula: cbcl_extern ~ 1 + event + sex + (1 | ids)
   Data: df_long
REML criterion at convergence: 588.7995
Random effects:
 Groups   Name        Std.Dev.
 ids      (Intercept) 5.020   
 Residual             3.587   
Number of obs: 99, groups:  ids, 37
Fixed Effects:
(Intercept)  eventYear_1  eventYear_2      sexMale  
     4.3204       0.7650       1.7481       0.5837  </code></pre>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>The code snippet above tells R to run a linear mixed model using lmer from the lme4 library. The left side of the â€œ~â€ symbol specifies the dependent variable; the right side specifies days as the independent variable(s). The code (1 | Subject) specifies a random intercept for each subject.</p>
</blockquote>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/model-output_3083f990489365c114103092ca5d408b">
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">## Output and reports extending from the LMM-ri analyses</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">summary</span>(random_intercepts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: cbcl_extern ~ 1 + event + sex + (1 | ids)
   Data: df_long

REML criterion at convergence: 588.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.7239 -0.4710 -0.1888  0.2910  2.9047 

Random effects:
 Groups   Name        Variance Std.Dev.
 ids      (Intercept) 25.20    5.020   
 Residual             12.86    3.587   
Number of obs: 99, groups:  ids, 37

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)   
(Intercept)   4.3204     1.3277 46.9852   3.254  0.00211 **
eventYear_1   0.7650     0.8768 62.6158   0.873  0.38626   
eventYear_2   1.7481     0.9173 63.4712   1.906  0.06123 . 
sexMale       0.5837     1.8240 36.0452   0.320  0.75081   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) evnY_1 evnY_2
eventYear_1 -0.343              
eventYear_2 -0.317  0.475       
sexMale     -0.631  0.032  0.013</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">confint</span>(random_intercepts, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %   97.5 %
.sig01               NA       NA
.sigma               NA       NA
(Intercept)  1.71808695 6.922714
eventYear_1 -0.95342829 2.483383
eventYear_2 -0.04987969 3.546050
sexMale     -2.99121329 4.158581</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">report</span>(random_intercepts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict cbcl_extern with event and sex (formula: cbcl_extern ~ 1 + event +
sex). The model included ids as random effect (formula: ~1 | ids). The model's
total explanatory power is substantial (conditional R2 = 0.67) and the part
related to the fixed effects alone (marginal R2) is of 0.02. The model's
intercept, corresponding to event = Baseline and sex = Female, is at 4.32 (95%
CI [1.68, 6.96], t(93) = 3.25, p = 0.002). Within this model:

  - The effect of event [Year_1] is statistically non-significant and positive
(beta = 0.76, 95% CI [-0.98, 2.51], t(93) = 0.87, p = 0.385; Std. beta = 0.12,
95% CI [-0.16, 0.40])
  - The effect of event [Year_2] is statistically non-significant and positive
(beta = 1.75, 95% CI [-0.07, 3.57], t(93) = 1.91, p = 0.060; Std. beta = 0.28,
95% CI [-0.01, 0.58])
  - The effect of sex [Male] is statistically non-significant and positive (beta
= 0.58, 95% CI [-3.04, 4.21], t(93) = 0.32, p = 0.750; Std. beta = 0.09, 95% CI
[-0.49, 0.68])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">report_performance</span>(random_intercepts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The model's total explanatory power is substantial (conditional R2 = 0.67) and
the part related to the fixed effects alone (marginal R2) is of 0.02</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">report_statistics</span>(random_intercepts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>beta = 4.32, 95% CI [1.68, 6.96], t(93) = 3.25, p = 0.002; Std. beta = -0.22, 95% CI [-0.64, 0.21]
beta = 0.76, 95% CI [-0.98, 2.51], t(93) = 0.87, p = 0.385; Std. beta = 0.12, 95% CI [-0.16, 0.40]
beta = 1.75, 95% CI [-0.07, 3.57], t(93) = 1.91, p = 0.060; Std. beta = 0.28, 95% CI [-0.01, 0.58]
beta = 0.58, 95% CI [-3.04, 4.21], t(93) = 0.32, p = 0.750; Std. beta = 0.09, 95% CI [-0.49, 0.68]</code></pre>
</div>
<details open="">
<summary>testing</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_grouplevel</span>(random_intercepts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/mod-report_be6d8355898444bc81d86031e79d22db">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#df_long %&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#  report() %&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#  summary()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualizations" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="visualizations">Visualizations</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset page-columns page-full">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Extract Params</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Diagnostic Plots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Bar Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Random Intercept LMM Plot/Graph</a></li></ul>
<div class="tab-content page-columns page-full">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="blue">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/extrct-FE_0827f4b630cb93461432a0bbf969153c">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="do">## Obtain LMM-ri model parameters to plot/graph of results</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>model_intercept <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">fixef</span>(random_intercepts)[<span class="dv">1</span>])</span>
<span id="cb22-3"><a href="#cb22-3"></a>model_slope <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">fixef</span>(random_intercepts)[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<blockquote class="blockquote">
<p>This code allows for extracting the fixed effects estimates for the model intercept and slope.</p>
</blockquote>
<div class="blue">

</div>
<blockquote class="blockquote">
<p>Extract the individual participant intercepts (random effects) for this model and add it to the data frame for plotting</p>
</blockquote>
</div>
<div id="tabset-4-2" class="tab-pane page-columns page-full" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="blue page-columns page-full">
<div class="cell column-screen-inset-shaded quarto-layout-panel" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/diag-plots_65f49891a93a44b781054b2357700027">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Build diagnostic plots. Observations with a Bonferroni p &lt; .05 might be considered as outliers and might need further investigation.</p>
</blockquote>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell" data-messages="false" data-hash="3a_HowTos_LinearMixedModels_cache/html/barplot_08b7b2314a0caee13c8e4cc765e7a154">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Basic ggplot2 barplot with mean</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>p<span class="ot">&lt;-</span>df_long <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mature_vg)) <span class="sc">%&gt;%</span> <span class="co"># filter on non-missing values  </span></span>
<span id="cb23-4"><a href="#cb23-4"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> cbcl_extern, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb23-6"><a href="#cb23-6"></a>           <span class="at">stat =</span> <span class="st">"summary"</span>,</span>
<span id="cb23-7"><a href="#cb23-7"></a>           <span class="at">fun =</span> <span class="st">"mean"</span>,</span>
<span id="cb23-8"><a href="#cb23-8"></a>           <span class="co">#fill = "#AA4A44",</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>           <span class="co">#color = "#0099f9"</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>           ) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="co">#scale_fill_brewer(palette = "Set1") +</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3db5ff"</span>, <span class="st">"#0099f9"</span>)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>    <span class="co">#scale_fill_gradient(high = "#B00B69", low = "#0e0e63") +</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>    <span class="co">#geom_text(aes(label = cu_traits), position = position_dodge(0.9), </span></span>
<span id="cb23-15"><a href="#cb23-15"></a>              <span class="co">#vjust = 2, size = 4, color = "#ffffff") +</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Behavior Problems by Video Game Groups"</span>, <span class="at">subtitle =</span> <span class="st">"Simple bar chart"</span>,</span>
<span id="cb23-17"><a href="#cb23-17"></a>         <span class="at">caption =</span> <span class="st">"Simple caption"</span>, <span class="at">x =</span> <span class="st">"DBD Group"</span>, <span class="at">y =</span> <span class="st">"CBCL Externalizing"</span>) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>              <span class="co">#coord_flip() +</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>    <span class="co">#geom_hline(yintercept = mean(df$cbcl_agg), linetype = "dashed", size = 1) +</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>    <span class="fu">theme</span>(</span>
<span id="cb23-22"><a href="#cb23-22"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-23"><a href="#cb23-23"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb23-24"><a href="#cb23-24"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb23-25"><a href="#cb23-25"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb23-26"><a href="#cb23-26"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb23-27"><a href="#cb23-27"></a>  )</span>
<span id="cb23-28"><a href="#cb23-28"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/barplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="blue">
<div class="cell" data-messages="false" data-fig.asp="0.61" data-hash="3a_HowTos_LinearMixedModels_cache/html/my-figure_76209778dc4652a350e64354d1a442b4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">#random_intercepts &lt;- lmer(Externalizing ~ 1 + Event + DBD + Sex + (1|ids), data = df, #REML=T)</span></span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="do">## LMM-ri plot of estimated random intercepts </span></span>
<span id="cb24-4"><a href="#cb24-4"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> mature_vg <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> sex), <span class="at">data =</span> df_long)</span>
<span id="cb24-5"><a href="#cb24-5"></a>preds <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model, <span class="at">include_random =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="do">## Adding fixed effect trajectory to LMM-ri plot </span></span>
<span id="cb24-8"><a href="#cb24-8"></a>fixed_pred <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model) <span class="co"># This time, include_random is FALSE (default)</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="fu">plot</span>(preds, <span class="at">ribbon =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># Previous plot</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">ymin =</span> CI_low, <span class="at">ymax =</span> CI_high), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> Predicted), <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3a_HowTos_LinearMixedModels_files/figure-html/my-figure-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">This is a caption for my figure, using YAML formatting, etc.#|</figcaption>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="do">######</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co"># ggplot(df_long_sub, aes(x = event, y = cbcl_agg, color=sex, shape=sex)) + </span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co"># geom_abline(slope = model_slope, intercept = model_intercept, linetype = "solid", color = "red", linewidth = 1) + </span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co"># geom_point(color = "grey70") + </span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co"># geom_smooth(method=lm, se=FALSE, fullrange=TRUE)+</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co"># scale_shape() + </span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co"># geom_segment(aes(x = event, xend = event, y = cbcl_agg, yend = fitted(cbcl_agg)), color = "grey70") + </span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="co"># scale_y_continuous(expand = c(0, 0), breaks = c(0, 20, 40, 60, 80, 100), limits = c(0, 100)) + </span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co"># scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4), limits = c(0, 4)) +</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="co"># theme(panel.background = element_blank(),         </span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="co">#         panel.grid.major = element_blank(),</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co">#         panel.grid.minor = element_blank(),</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="co">#         panel.border = element_rect(colour = "black", fill = NA),</span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co">#         legend.position = "none",</span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="co">#         axis.text = element_text(size = 14), </span></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="co">#         axis.title = element_text(size = 14)) +</span></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co">#         labs (x = "Event", y= "CBCL Aggression")</span></span>
<span id="cb25-18"><a href="#cb25-18"></a></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="co">#Save the plot</span></span>
<span id="cb25-20"><a href="#cb25-20"></a><span class="co">#ggsave("random_intercept.png", units = "in", width = 9, height = 6, dpi = 300)  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<p class="text-center" style="background-color: gray">
Figure x: The overall group-mean (fixed effects) trajectory is shown in blue. The faded lines represent each individual youthâ€™s estimated trajectory. An examination of this figure shows happiness scores to be increasing across measurement occasions, however, there appears to be substantial variability in the youthâ€™s initial happiness scores.
</p>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<p>The estimated correlation between x and y was â€œr cor(x,y)<code>. There are "r nrow(my_data)</code> individuals.</p>
<p>From the fixed effects section of the model summary, we can conclude that there is strong evidence that RT increased significantly over time (i.e., # of years). On average for each additional year, RT increased by 10.46 (b = 10.46, SE = 0.80, p &lt; .001).We are 95% confident that the average increase was between 8.89 and 12.04.</p>
<p>In the above, we estimate that the average intercept across all participants is 251.4. Results from the random effects section below show that the variance of the intercept for Subject is 1378.2. Taking the square root, the standard deviation of the intercept is thus 37.1.</p>
<p>We can calculate the 95% coverage interval as 251.4 Â± 1.96*37.1. The lower bound of the 95% coverage interval is thus 178.7 and the upper bound is 324.1. We therefore estimated that 95% of the participants have an intercept between 178.7 and 324.1. This means that 95% of the participants have a reaction time between 178.7 and 324.1 at Day 0. This is not to be confused with the 95% confidence interval of the intercept. The 95% confidence interval is (232.3, 270.5), and this indicates that we are 95% confident that the average intercept is somewhere between 232.3 and 270.5.</p>
<p>In this model, we have accounted for the repeated measures design (observations nested within individuals) by including a random intercept for each participants. Each individual has his/her own intercept. The effect of time(Year) on RT is assumed to be the same across individuals. This assumption can be relaxed by fitting a random slope model.</p>
</section>
<section id="mock-write-up" class="level4">
<h4 class="anchored" data-anchor-id="mock-write-up">Mock Write-up</h4>
<p>A random slope model is used to test if sleep deprivation affects reaction time. To account for the repeated measures design, a random intercept was specified for participants. The random slope for days of sleep deprivation was included in the model to allow the effect of sleep deprivation to vary across participants. Results are shown in Table 1. Using a significant level of 0.05, results indicate that sleep deprivation significantly increased reaction time. On average, each additional day of sleep deprivation increased reaction time by 10.47ms (b = 10.47, 95% CI = [7.44, 13.50], p &lt; .001). Model fit comparison between model with and without random slope for sleep deprivation shows that the effect of sleep deprivation varied across participants, Ï‡2(2)= 42.14, p &lt; .001. The 95% coverage interval for the random slope of sleep deprivation is (-1.14, 22.07), indicating that the effect of sleep deprivation was between -1.14 and 22.07 for 95% of the participants. :::</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p><span class="citation" data-cites="brown2021">(<a href="#ref-brown2021" role="doc-biblioref"><strong>brown2021?</strong></a>)</span> <!-- [@Singmann2019]
[@sarafian]
[#@https://m-clark.github.io/]
[#@Fitzmaurice]
[#@mspeekenbrink.github.io]
[#https://cran.r-project.org/web/packages/lme4/lme4.pdf] --></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/swhawes\.github\.io\/test\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./2_HowTos_ResidualizedChangeScores.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Residualized Change Scores</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4_HowTos_SignedRankTest.html" class="pagination-link">
        <span class="nav-page-text">Signed-Rank Test</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">---</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="an">title:</span><span class="co"> "Linear Mixed Models: Random Intercept"</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="an">author:</span><span class="co"> "Biostatistics Working Group"</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">---</span></span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="fu">## Linear Mixed Model with a Random-Intercept (LMM:ri)</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="kw">&lt;p&gt;</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>The LMM:ri is similar to traditional (fixed-effect) linear regression extending on this approach by including a subject-specific random-effect that allows each participant to have their own unique intercept value, in addition to the overall mean-level (fixed-effect) intercept value zzzzt</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a>In this example, we will use the LMM:ri to analyze trajectories of scores on the externalizing subscale of the child behavior checklist (CBCL) obtained across three measurement occasions in a sample of youth taking part in the ABCD Study. Our primary aim is to characterize stability and change in CBCL externalizing scores across assessments, while accounting for observations that are clustered within youth over time. To do so, we will use the LMM:ri to simultaneously model an overall sample mean trajectory (fixed effect) and subject-specific (random) effects that vary randomly about the sample mean trajectory. </span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="kw">&lt;/p&gt;</span></span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="fu">## Preliminary Setup</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>::: {.panel-tabset}</span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="fu">### Load Libraries {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>example-text before code block</span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="in">```{r pckg-install}</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-22"><a href="#cb26-22"></a></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="do">## Install necessary packages (if not already installed)</span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"lme4"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"lme4"</span>)</span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"lmerTest"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"lmerTest"</span>)</span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"tidyverse"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"arrow"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"arrow"</span>)</span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"afex"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"afex"</span>)</span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"janitor"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"janitor"</span>)</span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"skimr"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"skimr"</span>)</span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"sdamr"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"sdamr"</span>)</span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"formatR"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"formatR"</span>)</span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"report"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"easystats"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"easystats"</span>)</span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"emmeans"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"emmeans"</span>)</span>
<span id="cb26-36"><a href="#cb26-36"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"poorman"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"poorman"</span>)</span>
<span id="cb26-37"><a href="#cb26-37"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"parameters"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"parameters"</span>)</span>
<span id="cb26-38"><a href="#cb26-38"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"modelbased"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"modelbased"</span>)</span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"DT"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"DT"</span>)</span>
<span id="cb26-40"><a href="#cb26-40"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"data.table"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"data.table"</span>)</span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"arsenal"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"arsenal"</span>)</span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"kableExtra"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb26-43"><a href="#cb26-43"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"equatiomatic"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"equatiomatic"</span>)</span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"gtsummary"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span>
<span id="cb26-45"><a href="#cb26-45"></a><span class="in">```</span></span>
<span id="cb26-46"><a href="#cb26-46"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-47"><a href="#cb26-47"></a>example-text after code block</span>
<span id="cb26-48"><a href="#cb26-48"></a></span>
<span id="cb26-49"><a href="#cb26-49"></a><span class="fu">### Load Packages</span></span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-51"><a href="#cb26-51"></a><span class="in">```{r pckg-load}</span></span>
<span id="cb26-52"><a href="#cb26-52"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-53"><a href="#cb26-53"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-54"><a href="#cb26-54"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-55"><a href="#cb26-55"></a><span class="co">#| class.source: fold-hide</span></span>
<span id="cb26-56"><a href="#cb26-56"></a></span>
<span id="cb26-57"><a href="#cb26-57"></a><span class="do">## Load packages</span></span>
<span id="cb26-58"><a href="#cb26-58"></a><span class="fu">library</span>(lme4)</span>
<span id="cb26-59"><a href="#cb26-59"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb26-60"><a href="#cb26-60"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb26-61"><a href="#cb26-61"></a><span class="fu">library</span>(arrow)</span>
<span id="cb26-62"><a href="#cb26-62"></a><span class="fu">library</span>(afex)</span>
<span id="cb26-63"><a href="#cb26-63"></a><span class="fu">library</span>(janitor)</span>
<span id="cb26-64"><a href="#cb26-64"></a><span class="fu">library</span>(skimr)</span>
<span id="cb26-65"><a href="#cb26-65"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb26-66"><a href="#cb26-66"></a><span class="fu">library</span>(formatR)</span>
<span id="cb26-67"><a href="#cb26-67"></a><span class="fu">library</span>(report)</span>
<span id="cb26-68"><a href="#cb26-68"></a><span class="fu">library</span>(easystats)</span>
<span id="cb26-69"><a href="#cb26-69"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb26-70"><a href="#cb26-70"></a><span class="fu">library</span>(poorman)</span>
<span id="cb26-71"><a href="#cb26-71"></a><span class="fu">library</span>(parameters)</span>
<span id="cb26-72"><a href="#cb26-72"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb26-73"><a href="#cb26-73"></a><span class="fu">library</span>(DT)</span>
<span id="cb26-74"><a href="#cb26-74"></a><span class="fu">library</span>(data.table)</span>
<span id="cb26-75"><a href="#cb26-75"></a><span class="fu">library</span>(arsenal)</span>
<span id="cb26-76"><a href="#cb26-76"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb26-77"><a href="#cb26-77"></a><span class="fu">library</span>(equatiomatic)</span>
<span id="cb26-78"><a href="#cb26-78"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb26-79"><a href="#cb26-79"></a><span class="in">```</span></span>
<span id="cb26-80"><a href="#cb26-80"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-81"><a href="#cb26-81"></a></span>
<span id="cb26-82"><a href="#cb26-82"></a><span class="fu">### Config Options</span></span>
<span id="cb26-83"><a href="#cb26-83"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-84"><a href="#cb26-84"></a><span class="in">```{r config}</span></span>
<span id="cb26-85"><a href="#cb26-85"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-86"><a href="#cb26-86"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-87"><a href="#cb26-87"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-88"><a href="#cb26-88"></a></span>
<span id="cb26-89"><a href="#cb26-89"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> T, <span class="at">message=</span>F, <span class="at">warning=</span>F, <span class="at">error=</span>F, </span>
<span id="cb26-90"><a href="#cb26-90"></a>                      <span class="at">comment=</span><span class="cn">NA</span>, <span class="at">cache=</span>T, <span class="at">code_folding=</span>T,</span>
<span id="cb26-91"><a href="#cb26-91"></a>                      <span class="at">R.options=</span><span class="fu">list</span>(<span class="at">width=</span><span class="dv">220</span>), <span class="at">fig.align=</span><span class="st">'center'</span>, </span>
<span id="cb26-92"><a href="#cb26-92"></a>                      <span class="at">out.width=</span><span class="st">'75%'</span>, <span class="at">fig.asp=</span>.<span class="dv">75</span>)</span>
<span id="cb26-93"><a href="#cb26-93"></a><span class="in">```</span></span>
<span id="cb26-94"><a href="#cb26-94"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-95"><a href="#cb26-95"></a>:::</span>
<span id="cb26-96"><a href="#cb26-96"></a></span>
<span id="cb26-97"><a href="#cb26-97"></a></span>
<span id="cb26-98"><a href="#cb26-98"></a><span class="fu">## Descriptives Overview</span></span>
<span id="cb26-99"><a href="#cb26-99"></a>::: {.panel-tabset}</span>
<span id="cb26-100"><a href="#cb26-100"></a><span class="fu">### Data Table {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb26-101"><a href="#cb26-101"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-102"><a href="#cb26-102"></a><span class="in">```{r data-table}</span></span>
<span id="cb26-103"><a href="#cb26-103"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-104"><a href="#cb26-104"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-105"><a href="#cb26-105"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-106"><a href="#cb26-106"></a></span>
<span id="cb26-107"><a href="#cb26-107"></a>df_long<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/shawes/Desktop/data/df_long.csv"</span>)</span>
<span id="cb26-108"><a href="#cb26-108"></a><span class="co">#df_long_sub&lt;- read_csv("/Users/shawes/Desktop/df_long_sub.csv")</span></span>
<span id="cb26-109"><a href="#cb26-109"></a></span>
<span id="cb26-110"><a href="#cb26-110"></a><span class="do">## Create a viewable 'datatable' of the primary dataframe (df)</span></span>
<span id="cb26-111"><a href="#cb26-111"></a><span class="fu">datatable</span>(<span class="fu">head</span>(df_long, <span class="dv">50</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>),<span class="at">extensions =</span> <span class="st">'AutoFill'</span>,<span class="st">'ColReorder'</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">autoFill =</span> <span class="cn">TRUE</span>,<span class="at">colReorder =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-112"><a href="#cb26-112"></a>  <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-center'</span>, <span class="at">targets =</span> <span class="dv">10</span>)),</span>
<span id="cb26-113"><a href="#cb26-113"></a>  <span class="at">order =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">3</span>, <span class="st">'asc'</span>), <span class="fu">list</span>(<span class="dv">4</span>, <span class="st">'desc'</span>)),</span>
<span id="cb26-114"><a href="#cb26-114"></a>  <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb26-115"><a href="#cb26-115"></a>  <span class="at">lengthMenu =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb26-116"><a href="#cb26-116"></a>  <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb26-117"><a href="#cb26-117"></a>    <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb26-118"><a href="#cb26-118"></a>    <span class="st">"$(this.api().table().header()).css({'background-color': '#808080', 'color': '#fff'});"</span>,</span>
<span id="cb26-119"><a href="#cb26-119"></a>    <span class="st">"}"</span>)</span>
<span id="cb26-120"><a href="#cb26-120"></a>))</span>
<span id="cb26-121"><a href="#cb26-121"></a></span>
<span id="cb26-122"><a href="#cb26-122"></a><span class="do">## Not run: </span></span>
<span id="cb26-123"><a href="#cb26-123"></a><span class="co"># Specify table size by pixels</span></span>
<span id="cb26-124"><a href="#cb26-124"></a><span class="co">#kable(cbind(df_long, df_long), "html") %&gt;%</span></span>
<span id="cb26-125"><a href="#cb26-125"></a><span class="co">#    kable_styling() %&gt;%</span></span>
<span id="cb26-126"><a href="#cb26-126"></a><span class="co">#    scroll_box(width = "100%", height = "500px")</span></span>
<span id="cb26-127"><a href="#cb26-127"></a><span class="in">```</span></span>
<span id="cb26-128"><a href="#cb26-128"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-129"><a href="#cb26-129"></a></span>
<span id="cb26-130"><a href="#cb26-130"></a><span class="fu">### Descriptives</span></span>
<span id="cb26-131"><a href="#cb26-131"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-132"><a href="#cb26-132"></a><span class="in">```{r descriptives}</span></span>
<span id="cb26-133"><a href="#cb26-133"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-134"><a href="#cb26-134"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-135"><a href="#cb26-135"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-136"><a href="#cb26-136"></a><span class="co">#| results: "asis"</span></span>
<span id="cb26-137"><a href="#cb26-137"></a></span>
<span id="cb26-138"><a href="#cb26-138"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb26-139"><a href="#cb26-139"></a>descriptives_1  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb26-140"><a href="#cb26-140"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb26-141"><a href="#cb26-141"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span> </span>
<span id="cb26-142"><a href="#cb26-142"></a>                                               ), <span class="co">#"Nmiss2"</span></span>
<span id="cb26-143"><a href="#cb26-143"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co">#"Nmiss2"</span></span>
<span id="cb26-144"><a href="#cb26-144"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb26-145"><a href="#cb26-145"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb26-146"><a href="#cb26-146"></a>                                                 )) <span class="co">#, Nmiss2 ='Missing'</span></span>
<span id="cb26-147"><a href="#cb26-147"></a></span>
<span id="cb26-148"><a href="#cb26-148"></a>my_cont_labels <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb26-149"><a href="#cb26-149"></a>  <span class="at">age =</span> <span class="st">"Age"</span>,</span>
<span id="cb26-150"><a href="#cb26-150"></a>  <span class="at">vg_total =</span> <span class="st">"Weekly # of Video Gaming Hrs"</span>,</span>
<span id="cb26-151"><a href="#cb26-151"></a>  <span class="at">cbcl_extern =</span> <span class="st">"CBCL Externalizing Scale"</span></span>
<span id="cb26-152"><a href="#cb26-152"></a>)</span>
<span id="cb26-153"><a href="#cb26-153"></a></span>
<span id="cb26-154"><a href="#cb26-154"></a>tab_descriptives_1 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> age <span class="sc">+</span> vg_total <span class="sc">+</span> </span>
<span id="cb26-155"><a href="#cb26-155"></a>                            cbcl_extern,</span>
<span id="cb26-156"><a href="#cb26-156"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_1)</span>
<span id="cb26-157"><a href="#cb26-157"></a></span>
<span id="cb26-158"><a href="#cb26-158"></a><span class="co">#summary(tab_descriptives_1, labelTranslations = my_cont_labels , text=TRUE, title = #"Continuous Outcomes", term.name = TRUE)</span></span>
<span id="cb26-159"><a href="#cb26-159"></a></span>
<span id="cb26-160"><a href="#cb26-160"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb26-161"><a href="#cb26-161"></a>tab_descriptives_1 <span class="sc">%&gt;%</span></span>
<span id="cb26-162"><a href="#cb26-162"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-163"><a href="#cb26-163"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Continuous Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-164"><a href="#cb26-164"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>,</span>
<span id="cb26-165"><a href="#cb26-165"></a>                <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb26-166"><a href="#cb26-166"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-167"><a href="#cb26-167"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-168"><a href="#cb26-168"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-169"><a href="#cb26-169"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-170"><a href="#cb26-170"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-171"><a href="#cb26-171"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-172"><a href="#cb26-172"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb26-173"><a href="#cb26-173"></a><span class="in">```</span></span>
<span id="cb26-174"><a href="#cb26-174"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-175"><a href="#cb26-175"></a></span>
<span id="cb26-176"><a href="#cb26-176"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-177"><a href="#cb26-177"></a><span class="in">```{r catvar-table}</span></span>
<span id="cb26-178"><a href="#cb26-178"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-179"><a href="#cb26-179"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-180"><a href="#cb26-180"></a><span class="co">#| results: "asis"</span></span>
<span id="cb26-181"><a href="#cb26-181"></a></span>
<span id="cb26-182"><a href="#cb26-182"></a><span class="do">## Create a descriptives table of study variables by measurement occasion </span></span>
<span id="cb26-183"><a href="#cb26-183"></a>descriptives_2  <span class="ot">&lt;-</span> <span class="fu">tableby.control</span>(<span class="at">test=</span><span class="cn">FALSE</span>, <span class="at">total=</span><span class="cn">FALSE</span>,</span>
<span id="cb26-184"><a href="#cb26-184"></a>                               <span class="at">numeric.test=</span><span class="st">"kwt"</span>, <span class="at">cat.test=</span><span class="st">"chisq"</span>,</span>
<span id="cb26-185"><a href="#cb26-185"></a>                               <span class="at">numeric.stats=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"meansd"</span>, <span class="st">"median"</span>, <span class="st">"range"</span></span>
<span id="cb26-186"><a href="#cb26-186"></a>                                               ), <span class="co"># "Nmiss2"</span></span>
<span id="cb26-187"><a href="#cb26-187"></a>                               <span class="at">cat.stats=</span><span class="fu">c</span>(<span class="st">"countpct"</span>), <span class="co"># "Nmiss2"</span></span>
<span id="cb26-188"><a href="#cb26-188"></a>                               <span class="at">stats.labels=</span><span class="fu">list</span>(<span class="at">N=</span><span class="st">'Count'</span>, <span class="at">meansd=</span><span class="st">"Mean (SD)"</span>, median</span>
<span id="cb26-189"><a href="#cb26-189"></a>                                                 <span class="ot">=</span><span class="st">'Median'</span>, <span class="at">range=</span><span class="st">'Min - Max'</span></span>
<span id="cb26-190"><a href="#cb26-190"></a>                                                 )) <span class="co"># , Nmiss2 ='Missing'</span></span>
<span id="cb26-191"><a href="#cb26-191"></a></span>
<span id="cb26-192"><a href="#cb26-192"></a>my_cat_labels  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb26-193"><a href="#cb26-193"></a>  <span class="at">event =</span> <span class="st">"Year"</span>,</span>
<span id="cb26-194"><a href="#cb26-194"></a>  <span class="at">sex =</span> <span class="st">"Sex"</span>,</span>
<span id="cb26-195"><a href="#cb26-195"></a>  <span class="at">mature_vg =</span> <span class="st">"Mature Video Games"</span></span>
<span id="cb26-196"><a href="#cb26-196"></a>  )</span>
<span id="cb26-197"><a href="#cb26-197"></a></span>
<span id="cb26-198"><a href="#cb26-198"></a>tab_descriptives_2 <span class="ot">&lt;-</span> <span class="fu">tableby</span>(event <span class="sc">~</span> sex <span class="sc">+</span> mature_vg, </span>
<span id="cb26-199"><a href="#cb26-199"></a>                            <span class="at">data=</span>df_long, <span class="at">control=</span>descriptives_2)</span>
<span id="cb26-200"><a href="#cb26-200"></a></span>
<span id="cb26-201"><a href="#cb26-201"></a><span class="co">#summary(tab_descriptives_2, labelTranslations = my_cat_labels , text=TRUE, title = #"Categorical Outcomes", term.name = TRUE)</span></span>
<span id="cb26-202"><a href="#cb26-202"></a></span>
<span id="cb26-203"><a href="#cb26-203"></a><span class="co"># Push table object through kable and kable_styling</span></span>
<span id="cb26-204"><a href="#cb26-204"></a>tab_descriptives_2 <span class="sc">%&gt;%</span></span>
<span id="cb26-205"><a href="#cb26-205"></a>  <span class="fu">summary</span>(<span class="at">text=</span><span class="cn">TRUE</span>, <span class="at">digits.pct=</span><span class="dv">1</span>, <span class="at">digits=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-206"><a href="#cb26-206"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Categorical Outcomes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-207"><a href="#cb26-207"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">font_size =</span> <span class="dv">15</span>,</span>
<span id="cb26-208"><a href="#cb26-208"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-209"><a href="#cb26-209"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,  <span class="at">bold =</span> F, <span class="at">extra_css =</span> <span class="st">'vertical-align: middle !important;'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-210"><a href="#cb26-210"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">background =</span> <span class="st">"light grey"</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-211"><a href="#cb26-211"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb26-212"><a href="#cb26-212"></a>  <span class="co">#column_spec(3, width = "20em", border_right = T) %&gt;%</span></span>
<span id="cb26-213"><a href="#cb26-213"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Here is a general comments of the table. "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-214"><a href="#cb26-214"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"75%"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb26-215"><a href="#cb26-215"></a></span>
<span id="cb26-216"><a href="#cb26-216"></a><span class="in">```</span></span>
<span id="cb26-217"><a href="#cb26-217"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-218"><a href="#cb26-218"></a>:::</span>
<span id="cb26-219"><a href="#cb26-219"></a></span>
<span id="cb26-220"><a href="#cb26-220"></a><span class="fu">## Results </span></span>
<span id="cb26-221"><a href="#cb26-221"></a>::: {.panel-tabset}</span>
<span id="cb26-222"><a href="#cb26-222"></a><span class="fu">### Build Model {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb26-223"><a href="#cb26-223"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-224"><a href="#cb26-224"></a><span class="in">```{r build-model}</span></span>
<span id="cb26-225"><a href="#cb26-225"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-226"><a href="#cb26-226"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-227"><a href="#cb26-227"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-228"><a href="#cb26-228"></a></span>
<span id="cb26-229"><a href="#cb26-229"></a><span class="do">## Linear Mixed Model with a random intercept (LMM-ri)</span></span>
<span id="cb26-230"><a href="#cb26-230"></a>random_intercepts <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> event <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ids), <span class="at">data =</span> df_long, <span class="at">REML=</span>T)</span>
<span id="cb26-231"><a href="#cb26-231"></a></span>
<span id="cb26-232"><a href="#cb26-232"></a><span class="fu">print</span>(random_intercepts)</span>
<span id="cb26-233"><a href="#cb26-233"></a><span class="in">```</span></span>
<span id="cb26-234"><a href="#cb26-234"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-235"><a href="#cb26-235"></a></span>
<span id="cb26-236"><a href="#cb26-236"></a><span class="at">&gt; The code snippet above tells R to run a linear mixed model using lmer</span></span>
<span id="cb26-237"><a href="#cb26-237"></a><span class="at">&gt; from the lme4 library. The left side of the "\~" symbol specifies the</span></span>
<span id="cb26-238"><a href="#cb26-238"></a><span class="at">&gt; dependent variable; the right side specifies days as the independent</span></span>
<span id="cb26-239"><a href="#cb26-239"></a><span class="at">&gt; variable(s). The code (1 \| Subject) specifies a random intercept for</span></span>
<span id="cb26-240"><a href="#cb26-240"></a><span class="at">&gt; each subject.</span></span>
<span id="cb26-241"><a href="#cb26-241"></a></span>
<span id="cb26-242"><a href="#cb26-242"></a><span class="fu">### Model Output</span></span>
<span id="cb26-243"><a href="#cb26-243"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-244"><a href="#cb26-244"></a><span class="in">```{r model-output}</span></span>
<span id="cb26-245"><a href="#cb26-245"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-246"><a href="#cb26-246"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-247"><a href="#cb26-247"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-248"><a href="#cb26-248"></a><span class="co">#| code-summary: testing</span></span>
<span id="cb26-249"><a href="#cb26-249"></a></span>
<span id="cb26-250"><a href="#cb26-250"></a><span class="do">## Output and reports extending from the LMM-ri analyses</span></span>
<span id="cb26-251"><a href="#cb26-251"></a><span class="fu">summary</span>(random_intercepts)</span>
<span id="cb26-252"><a href="#cb26-252"></a><span class="fu">confint</span>(random_intercepts, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb26-253"><a href="#cb26-253"></a><span class="fu">report</span>(random_intercepts)</span>
<span id="cb26-254"><a href="#cb26-254"></a><span class="fu">report_performance</span>(random_intercepts)</span>
<span id="cb26-255"><a href="#cb26-255"></a><span class="fu">report_statistics</span>(random_intercepts)</span>
<span id="cb26-256"><a href="#cb26-256"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_grouplevel</span>(random_intercepts)</span>
<span id="cb26-257"><a href="#cb26-257"></a><span class="in">```</span></span>
<span id="cb26-258"><a href="#cb26-258"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-259"><a href="#cb26-259"></a></span>
<span id="cb26-260"><a href="#cb26-260"></a><span class="fu">### Model Report</span></span>
<span id="cb26-261"><a href="#cb26-261"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-262"><a href="#cb26-262"></a><span class="in">```{r mod-report}</span></span>
<span id="cb26-263"><a href="#cb26-263"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-264"><a href="#cb26-264"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-265"><a href="#cb26-265"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-266"><a href="#cb26-266"></a></span>
<span id="cb26-267"><a href="#cb26-267"></a><span class="co">#df_long %&gt;%</span></span>
<span id="cb26-268"><a href="#cb26-268"></a><span class="co">#  report() %&gt;%</span></span>
<span id="cb26-269"><a href="#cb26-269"></a><span class="co">#  summary()</span></span>
<span id="cb26-270"><a href="#cb26-270"></a><span class="in">```</span></span>
<span id="cb26-271"><a href="#cb26-271"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-272"><a href="#cb26-272"></a>:::</span>
<span id="cb26-273"><a href="#cb26-273"></a></span>
<span id="cb26-274"><a href="#cb26-274"></a><span class="fu">## Visualizations </span></span>
<span id="cb26-275"><a href="#cb26-275"></a>::: {.panel-tabset}</span>
<span id="cb26-276"><a href="#cb26-276"></a><span class="fu">### Extract Params {.tabset .tabset-fade .tabset-pills}</span></span>
<span id="cb26-277"><a href="#cb26-277"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-278"><a href="#cb26-278"></a><span class="in">```{r extrct-FE}</span></span>
<span id="cb26-279"><a href="#cb26-279"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-280"><a href="#cb26-280"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-281"><a href="#cb26-281"></a></span>
<span id="cb26-282"><a href="#cb26-282"></a><span class="do">## Obtain LMM-ri model parameters to plot/graph of results</span></span>
<span id="cb26-283"><a href="#cb26-283"></a>model_intercept <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">fixef</span>(random_intercepts)[<span class="dv">1</span>])</span>
<span id="cb26-284"><a href="#cb26-284"></a>model_slope <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">fixef</span>(random_intercepts)[<span class="dv">2</span>])</span>
<span id="cb26-285"><a href="#cb26-285"></a><span class="in">```</span></span>
<span id="cb26-286"><a href="#cb26-286"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-287"><a href="#cb26-287"></a></span>
<span id="cb26-288"><a href="#cb26-288"></a><span class="at">&gt; This code allows for extracting the fixed effects estimates for the</span></span>
<span id="cb26-289"><a href="#cb26-289"></a><span class="at">&gt; model intercept and slope.</span></span>
<span id="cb26-290"><a href="#cb26-290"></a></span>
<span id="cb26-291"><a href="#cb26-291"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-292"><a href="#cb26-292"></a><span class="in">```{r extrct-RE}</span></span>
<span id="cb26-293"><a href="#cb26-293"></a><span class="co">#| class.source: 'fold-hide'</span></span>
<span id="cb26-294"><a href="#cb26-294"></a><span class="co">#| message: FALSE</span></span>
<span id="cb26-295"><a href="#cb26-295"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-296"><a href="#cb26-296"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb26-297"><a href="#cb26-297"></a></span>
<span id="cb26-298"><a href="#cb26-298"></a>intercepts <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">coef</span>(random_intercepts)<span class="sc">$</span>ids[,<span class="dv">1</span>], <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb26-299"><a href="#cb26-299"></a><span class="in">```</span></span>
<span id="cb26-300"><a href="#cb26-300"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-301"><a href="#cb26-301"></a></span>
<span id="cb26-302"><a href="#cb26-302"></a><span class="at">&gt; Extract the individual participant intercepts (random effects) for this model and add</span></span>
<span id="cb26-303"><a href="#cb26-303"></a><span class="at">&gt; it to the data frame for plotting</span></span>
<span id="cb26-304"><a href="#cb26-304"></a></span>
<span id="cb26-305"><a href="#cb26-305"></a><span class="fu">### Diagnostic Plots</span></span>
<span id="cb26-306"><a href="#cb26-306"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-307"><a href="#cb26-307"></a><span class="in">```{r diag-plots}</span></span>
<span id="cb26-308"><a href="#cb26-308"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-309"><a href="#cb26-309"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-310"><a href="#cb26-310"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb26-311"><a href="#cb26-311"></a><span class="co">#| column: screen-inset-shaded</span></span>
<span id="cb26-312"><a href="#cb26-312"></a><span class="co">#| layout-nrow: 2</span></span>
<span id="cb26-313"><a href="#cb26-313"></a> </span>
<span id="cb26-314"><a href="#cb26-314"></a><span class="do">## xxxxx plot</span></span>
<span id="cb26-315"><a href="#cb26-315"></a>random_intercepts.std <span class="ot">&lt;-</span> <span class="fu">resid</span>(random_intercepts)<span class="sc">/</span><span class="fu">sd</span>(<span class="fu">resid</span>(random_intercepts))</span>
<span id="cb26-316"><a href="#cb26-316"></a><span class="fu">plot</span>(random_intercepts.std, <span class="at">ylab=</span><span class="st">"Standardized Residuals"</span>)</span>
<span id="cb26-317"><a href="#cb26-317"></a></span>
<span id="cb26-318"><a href="#cb26-318"></a><span class="do">## Outlier Tests. </span></span>
<span id="cb26-319"><a href="#cb26-319"></a><span class="co">#car::outlierTest(random_intercepts)</span></span>
<span id="cb26-320"><a href="#cb26-320"></a>car<span class="sc">::</span><span class="fu">infIndexPlot</span>(random_intercepts)</span>
<span id="cb26-321"><a href="#cb26-321"></a></span>
<span id="cb26-322"><a href="#cb26-322"></a><span class="do">## qqplot</span></span>
<span id="cb26-323"><a href="#cb26-323"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(random_intercepts.std), <span class="fu">aes</span>(<span class="at">sample =</span> random_intercepts.std)) <span class="sc">+</span></span>
<span id="cb26-324"><a href="#cb26-324"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb26-325"><a href="#cb26-325"></a>  <span class="fu">geom_qq_line</span>()</span>
<span id="cb26-326"><a href="#cb26-326"></a></span>
<span id="cb26-327"><a href="#cb26-327"></a><span class="do">## Predicted vs Actual plot</span></span>
<span id="cb26-328"><a href="#cb26-328"></a>predicted <span class="ot">&lt;-</span> <span class="fu">estimate_expectation</span>(random_intercepts, <span class="at">data =</span> <span class="st">"grid"</span>)</span>
<span id="cb26-329"><a href="#cb26-329"></a><span class="fu">plot</span>(predicted)</span>
<span id="cb26-330"><a href="#cb26-330"></a></span>
<span id="cb26-331"><a href="#cb26-331"></a><span class="do">## Estimated means plot</span></span>
<span id="cb26-332"><a href="#cb26-332"></a>means <span class="ot">&lt;-</span> <span class="fu">estimate_means</span>(random_intercepts)</span>
<span id="cb26-333"><a href="#cb26-333"></a><span class="fu">plot</span>(means)</span>
<span id="cb26-334"><a href="#cb26-334"></a></span>
<span id="cb26-335"><a href="#cb26-335"></a><span class="in">```</span></span>
<span id="cb26-336"><a href="#cb26-336"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-337"><a href="#cb26-337"></a></span>
<span id="cb26-338"><a href="#cb26-338"></a><span class="at">&gt; Build diagnostic plots. Observations with a Bonferroni p </span><span class="sc">\&lt;</span><span class="at"> .05 might</span></span>
<span id="cb26-339"><a href="#cb26-339"></a><span class="at">&gt; be considered as outliers and might need further investigation.</span></span>
<span id="cb26-340"><a href="#cb26-340"></a></span>
<span id="cb26-341"><a href="#cb26-341"></a><span class="fu">### Bar Plot</span></span>
<span id="cb26-342"><a href="#cb26-342"></a><span class="in">```{r barplot}</span></span>
<span id="cb26-343"><a href="#cb26-343"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-344"><a href="#cb26-344"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-345"><a href="#cb26-345"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-346"><a href="#cb26-346"></a></span>
<span id="cb26-347"><a href="#cb26-347"></a><span class="co"># Basic ggplot2 barplot with mean</span></span>
<span id="cb26-348"><a href="#cb26-348"></a>p<span class="ot">&lt;-</span>df_long <span class="sc">%&gt;%</span></span>
<span id="cb26-349"><a href="#cb26-349"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mature_vg)) <span class="sc">%&gt;%</span> <span class="co"># filter on non-missing values  </span></span>
<span id="cb26-350"><a href="#cb26-350"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> cbcl_extern, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb26-351"><a href="#cb26-351"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb26-352"><a href="#cb26-352"></a>           <span class="at">stat =</span> <span class="st">"summary"</span>,</span>
<span id="cb26-353"><a href="#cb26-353"></a>           <span class="at">fun =</span> <span class="st">"mean"</span>,</span>
<span id="cb26-354"><a href="#cb26-354"></a>           <span class="co">#fill = "#AA4A44",</span></span>
<span id="cb26-355"><a href="#cb26-355"></a>           <span class="co">#color = "#0099f9"</span></span>
<span id="cb26-356"><a href="#cb26-356"></a>           ) <span class="sc">+</span></span>
<span id="cb26-357"><a href="#cb26-357"></a>    <span class="co">#scale_fill_brewer(palette = "Set1") +</span></span>
<span id="cb26-358"><a href="#cb26-358"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3db5ff"</span>, <span class="st">"#0099f9"</span>)) <span class="sc">+</span></span>
<span id="cb26-359"><a href="#cb26-359"></a>    <span class="co">#scale_fill_gradient(high = "#B00B69", low = "#0e0e63") +</span></span>
<span id="cb26-360"><a href="#cb26-360"></a>    <span class="co">#geom_text(aes(label = cu_traits), position = position_dodge(0.9), </span></span>
<span id="cb26-361"><a href="#cb26-361"></a>              <span class="co">#vjust = 2, size = 4, color = "#ffffff") +</span></span>
<span id="cb26-362"><a href="#cb26-362"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Behavior Problems by Video Game Groups"</span>, <span class="at">subtitle =</span> <span class="st">"Simple bar chart"</span>,</span>
<span id="cb26-363"><a href="#cb26-363"></a>         <span class="at">caption =</span> <span class="st">"Simple caption"</span>, <span class="at">x =</span> <span class="st">"DBD Group"</span>, <span class="at">y =</span> <span class="st">"CBCL Externalizing"</span>) <span class="sc">+</span></span>
<span id="cb26-364"><a href="#cb26-364"></a>              <span class="co">#coord_flip() +</span></span>
<span id="cb26-365"><a href="#cb26-365"></a>    <span class="co">#geom_hline(yintercept = mean(df$cbcl_agg), linetype = "dashed", size = 1) +</span></span>
<span id="cb26-366"><a href="#cb26-366"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-367"><a href="#cb26-367"></a>    <span class="fu">theme</span>(</span>
<span id="cb26-368"><a href="#cb26-368"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb26-369"><a href="#cb26-369"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb26-370"><a href="#cb26-370"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb26-371"><a href="#cb26-371"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0099f9"</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-372"><a href="#cb26-372"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb26-373"><a href="#cb26-373"></a>  )</span>
<span id="cb26-374"><a href="#cb26-374"></a>p</span>
<span id="cb26-375"><a href="#cb26-375"></a><span class="in">```</span></span>
<span id="cb26-376"><a href="#cb26-376"></a></span>
<span id="cb26-377"><a href="#cb26-377"></a><span class="fu">### Random Intercept LMM Plot/Graph</span></span>
<span id="cb26-378"><a href="#cb26-378"></a><span class="kw">&lt;div</span> <span class="er">class</span> <span class="ot">=</span> <span class="st">"blue"</span><span class="kw">&gt;</span></span>
<span id="cb26-379"><a href="#cb26-379"></a><span class="in">```{r lmmri-graph}</span></span>
<span id="cb26-380"><a href="#cb26-380"></a><span class="co">#| echo: TRUE</span></span>
<span id="cb26-381"><a href="#cb26-381"></a><span class="co">#| messages: FALSE</span></span>
<span id="cb26-382"><a href="#cb26-382"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb26-383"><a href="#cb26-383"></a><span class="co">#| label: my-figure</span></span>
<span id="cb26-384"><a href="#cb26-384"></a><span class="co">#| fig-asp: 0.61</span></span>
<span id="cb26-385"><a href="#cb26-385"></a><span class="co">#| fig-cap: |</span></span>
<span id="cb26-386"><a href="#cb26-386"></a><span class="co">#|   This is a caption for my figure, </span></span>
<span id="cb26-387"><a href="#cb26-387"></a><span class="co">#|   using YAML formatting, etc.#| </span></span>
<span id="cb26-388"><a href="#cb26-388"></a></span>
<span id="cb26-389"><a href="#cb26-389"></a><span class="co">#random_intercepts &lt;- lmer(Externalizing ~ 1 + Event + DBD + Sex + (1|ids), data = df, #REML=T)</span></span>
<span id="cb26-390"><a href="#cb26-390"></a></span>
<span id="cb26-391"><a href="#cb26-391"></a><span class="do">## LMM-ri plot of estimated random intercepts </span></span>
<span id="cb26-392"><a href="#cb26-392"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(cbcl_extern <span class="sc">~</span> mature_vg <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> sex), <span class="at">data =</span> df_long)</span>
<span id="cb26-393"><a href="#cb26-393"></a>preds <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model, <span class="at">include_random =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-394"><a href="#cb26-394"></a></span>
<span id="cb26-395"><a href="#cb26-395"></a><span class="do">## Adding fixed effect trajectory to LMM-ri plot </span></span>
<span id="cb26-396"><a href="#cb26-396"></a>fixed_pred <span class="ot">&lt;-</span> <span class="fu">estimate_relation</span>(model) <span class="co"># This time, include_random is FALSE (default)</span></span>
<span id="cb26-397"><a href="#cb26-397"></a><span class="fu">plot</span>(preds, <span class="at">ribbon =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># Previous plot</span></span>
<span id="cb26-398"><a href="#cb26-398"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">ymin =</span> CI_low, <span class="at">ymax =</span> CI_high), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb26-399"><a href="#cb26-399"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fixed_pred, <span class="fu">aes</span>(<span class="at">x =</span> mature_vg, <span class="at">y =</span> Predicted), <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb26-400"><a href="#cb26-400"></a></span>
<span id="cb26-401"><a href="#cb26-401"></a><span class="do">######</span></span>
<span id="cb26-402"><a href="#cb26-402"></a><span class="co"># ggplot(df_long_sub, aes(x = event, y = cbcl_agg, color=sex, shape=sex)) + </span></span>
<span id="cb26-403"><a href="#cb26-403"></a><span class="co"># geom_abline(slope = model_slope, intercept = model_intercept, linetype = "solid", color = "red", linewidth = 1) + </span></span>
<span id="cb26-404"><a href="#cb26-404"></a><span class="co"># geom_point(color = "grey70") + </span></span>
<span id="cb26-405"><a href="#cb26-405"></a><span class="co"># geom_smooth(method=lm, se=FALSE, fullrange=TRUE)+</span></span>
<span id="cb26-406"><a href="#cb26-406"></a><span class="co"># scale_shape() + </span></span>
<span id="cb26-407"><a href="#cb26-407"></a><span class="co"># geom_segment(aes(x = event, xend = event, y = cbcl_agg, yend = fitted(cbcl_agg)), color = "grey70") + </span></span>
<span id="cb26-408"><a href="#cb26-408"></a><span class="co"># scale_y_continuous(expand = c(0, 0), breaks = c(0, 20, 40, 60, 80, 100), limits = c(0, 100)) + </span></span>
<span id="cb26-409"><a href="#cb26-409"></a><span class="co"># scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4), limits = c(0, 4)) +</span></span>
<span id="cb26-410"><a href="#cb26-410"></a><span class="co"># theme(panel.background = element_blank(),         </span></span>
<span id="cb26-411"><a href="#cb26-411"></a><span class="co">#         panel.grid.major = element_blank(),</span></span>
<span id="cb26-412"><a href="#cb26-412"></a><span class="co">#         panel.grid.minor = element_blank(),</span></span>
<span id="cb26-413"><a href="#cb26-413"></a><span class="co">#         panel.border = element_rect(colour = "black", fill = NA),</span></span>
<span id="cb26-414"><a href="#cb26-414"></a><span class="co">#         legend.position = "none",</span></span>
<span id="cb26-415"><a href="#cb26-415"></a><span class="co">#         axis.text = element_text(size = 14), </span></span>
<span id="cb26-416"><a href="#cb26-416"></a><span class="co">#         axis.title = element_text(size = 14)) +</span></span>
<span id="cb26-417"><a href="#cb26-417"></a><span class="co">#         labs (x = "Event", y= "CBCL Aggression")</span></span>
<span id="cb26-418"><a href="#cb26-418"></a></span>
<span id="cb26-419"><a href="#cb26-419"></a><span class="co">#Save the plot</span></span>
<span id="cb26-420"><a href="#cb26-420"></a><span class="co">#ggsave("random_intercept.png", units = "in", width = 9, height = 6, dpi = 300)  </span></span>
<span id="cb26-421"><a href="#cb26-421"></a></span>
<span id="cb26-422"><a href="#cb26-422"></a></span>
<span id="cb26-423"><a href="#cb26-423"></a></span>
<span id="cb26-424"><a href="#cb26-424"></a><span class="in">```</span></span>
<span id="cb26-425"><a href="#cb26-425"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb26-426"><a href="#cb26-426"></a>:::</span>
<span id="cb26-427"><a href="#cb26-427"></a></span>
<span id="cb26-428"><a href="#cb26-428"></a><span class="kw">&lt;p</span> <span class="er">class</span><span class="ot">=</span><span class="st">"text-center"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"background-color: gray"</span><span class="kw">&gt;</span>Figure x: The overall group-mean (fixed effects) trajectory is shown in blue. The faded lines represent each individual youth's estimated trajectory. An examination of this figure shows happiness scores to be increasing across measurement occasions, however, there appears to be substantial variability in the youth's initial happiness scores.<span class="kw">&lt;/p&gt;</span></span>
<span id="cb26-429"><a href="#cb26-429"></a></span>
<span id="cb26-430"><a href="#cb26-430"></a><span class="fu">#### Interpretation</span></span>
<span id="cb26-431"><a href="#cb26-431"></a>The estimated correlation between x and y was "r cor(x,y)`.</span>
<span id="cb26-432"><a href="#cb26-432"></a>There are "r nrow(my_data)` individuals.</span>
<span id="cb26-433"><a href="#cb26-433"></a></span>
<span id="cb26-434"><a href="#cb26-434"></a>From the fixed effects section of the model summary, we can conclude</span>
<span id="cb26-435"><a href="#cb26-435"></a>that there is strong evidence that RT increased significantly over time</span>
<span id="cb26-436"><a href="#cb26-436"></a>(i.e., <span class="sc">\#</span> of years). On average for each additional year, RT increased</span>
<span id="cb26-437"><a href="#cb26-437"></a>by 10.46 (b = 10.46, SE = 0.80, p <span class="sc">\&lt;</span> .001).We are 95% confident that the</span>
<span id="cb26-438"><a href="#cb26-438"></a>average increase was between 8.89 and 12.04.</span>
<span id="cb26-439"><a href="#cb26-439"></a></span>
<span id="cb26-440"><a href="#cb26-440"></a>In the above, we estimate that the average intercept across all</span>
<span id="cb26-441"><a href="#cb26-441"></a>participants is 251.4. Results from the random effects section below</span>
<span id="cb26-442"><a href="#cb26-442"></a>show that the variance of the intercept for Subject is 1378.2. Taking</span>
<span id="cb26-443"><a href="#cb26-443"></a>the square root, the standard deviation of the intercept is thus 37.1.</span>
<span id="cb26-444"><a href="#cb26-444"></a></span>
<span id="cb26-445"><a href="#cb26-445"></a>We can calculate the 95% coverage interval as 251.4 Â± 1.96<span class="sc">\*</span>37.1. The</span>
<span id="cb26-446"><a href="#cb26-446"></a>lower bound of the 95% coverage interval is thus 178.7 and the upper</span>
<span id="cb26-447"><a href="#cb26-447"></a>bound is 324.1. We therefore estimated that 95% of the participants have</span>
<span id="cb26-448"><a href="#cb26-448"></a>an intercept between 178.7 and 324.1. This means that 95% of the</span>
<span id="cb26-449"><a href="#cb26-449"></a>participants have a reaction time between 178.7 and 324.1 at Day 0. This</span>
<span id="cb26-450"><a href="#cb26-450"></a>is not to be confused with the 95% confidence interval of the intercept.</span>
<span id="cb26-451"><a href="#cb26-451"></a>The 95% confidence interval is (232.3, 270.5), and this indicates that</span>
<span id="cb26-452"><a href="#cb26-452"></a>we are 95% confident that the average intercept is somewhere between</span>
<span id="cb26-453"><a href="#cb26-453"></a>232.3 and 270.5.</span>
<span id="cb26-454"><a href="#cb26-454"></a></span>
<span id="cb26-455"><a href="#cb26-455"></a>In this model, we have accounted for the repeated measures design</span>
<span id="cb26-456"><a href="#cb26-456"></a>(observations nested within individuals) by including a random intercept</span>
<span id="cb26-457"><a href="#cb26-457"></a>for each participants. Each individual has his/her own intercept. The</span>
<span id="cb26-458"><a href="#cb26-458"></a>effect of time(Year) on RT is assumed to be the same across individuals.</span>
<span id="cb26-459"><a href="#cb26-459"></a>This assumption can be relaxed by fitting a random slope model.</span>
<span id="cb26-460"><a href="#cb26-460"></a></span>
<span id="cb26-461"><a href="#cb26-461"></a><span class="fu">#### Mock Write-up</span></span>
<span id="cb26-462"><a href="#cb26-462"></a></span>
<span id="cb26-463"><a href="#cb26-463"></a>A random slope model is used to test if sleep deprivation affects</span>
<span id="cb26-464"><a href="#cb26-464"></a>reaction time. To account for the repeated measures design, a random</span>
<span id="cb26-465"><a href="#cb26-465"></a>intercept was specified for participants. The random slope for days of</span>
<span id="cb26-466"><a href="#cb26-466"></a>sleep deprivation was included in the model to allow the effect of sleep</span>
<span id="cb26-467"><a href="#cb26-467"></a>deprivation to vary across participants. Results are shown in Table 1.</span>
<span id="cb26-468"><a href="#cb26-468"></a>Using a significant level of 0.05, results indicate that sleep</span>
<span id="cb26-469"><a href="#cb26-469"></a>deprivation significantly increased reaction time. On average, each</span>
<span id="cb26-470"><a href="#cb26-470"></a>additional day of sleep deprivation increased reaction time by 10.47ms</span>
<span id="cb26-471"><a href="#cb26-471"></a>(b = 10.47, 95% CI = <span class="sc">\[</span>7.44, 13.50<span class="sc">\]</span>, p <span class="sc">\&lt;</span> .001). Model fit comparison</span>
<span id="cb26-472"><a href="#cb26-472"></a>between model with and without random slope for sleep deprivation shows</span>
<span id="cb26-473"><a href="#cb26-473"></a>that the effect of sleep deprivation varied across participants, Ï‡2(2)=</span>
<span id="cb26-474"><a href="#cb26-474"></a>42.14, p <span class="sc">\&lt;</span> .001. The 95% coverage interval for the random slope of</span>
<span id="cb26-475"><a href="#cb26-475"></a>sleep deprivation is (-1.14, 22.07), indicating that the effect of sleep</span>
<span id="cb26-476"><a href="#cb26-476"></a>deprivation was between -1.14 and 22.07 for 95% of the participants.</span>
<span id="cb26-477"><a href="#cb26-477"></a>:::</span>
<span id="cb26-478"><a href="#cb26-478"></a></span>
<span id="cb26-479"><a href="#cb26-479"></a><span class="fu">## References</span></span>
<span id="cb26-480"><a href="#cb26-480"></a></span>
<span id="cb26-481"><a href="#cb26-481"></a><span class="co">[</span><span class="ot">@brown2021</span><span class="co">]</span> <span class="co">&lt;!-- [@Singmann2019]</span></span>
<span id="cb26-482"><a href="#cb26-482"></a><span class="co">[@sarafian]</span></span>
<span id="cb26-483"><a href="#cb26-483"></a><span class="co">[#@https://m-clark.github.io/]</span></span>
<span id="cb26-484"><a href="#cb26-484"></a><span class="co">[#@Fitzmaurice]</span></span>
<span id="cb26-485"><a href="#cb26-485"></a><span class="co">[#@mspeekenbrink.github.io]</span></span>
<span id="cb26-486"><a href="#cb26-486"></a><span class="co">[#https://cran.r-project.org/web/packages/lme4/lme4.pdf] --&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./refernce.qmd">Longitudinal Analysis</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>