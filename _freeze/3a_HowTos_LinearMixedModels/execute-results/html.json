{
  "hash": "f3d09e5880058c4195b404f4428ecdad",
  "result": {
    "markdown": "---\ntitle: \"Linear Mixed Models: Random Intercept\"\nauthor: \"Biostatistics Working Group\"\n---\n\n\n## Linear Mixed Model with a Random-Intercept (LMM:ri)\n<p>\nThe LMM:ri is similar to traditional (fixed-effect) linear regression extending on this approach by including a subject-specific random-effect that allows each participant to have their own unique intercept value, in addition to the overall mean-level (fixed-effect) intercept value zzzzt\n\nIn this example, we will use the LMM:ri to analyze trajectories of scores on the externalizing subscale of the child behavior checklist (CBCL) obtained across three measurement occasions in a sample of youth taking part in the ABCD Study. Our primary aim is to characterize stability and change in CBCL externalizing scores across assessments, while accounting for observations that are clustered within youth over time. To do so, we will use the LMM:ri to simultaneously model an overall sample mean trajectory (fixed effect) and subject-specific (random) effects that vary randomly about the sample mean trajectory. \n</p>\n\n## Preliminary Setup\n::: {.panel-tabset}\n### Load Libraries {.tabset .tabset-fade .tabset-pills}\nexample-text before code block\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/pckg-install_3d220ea7ddb52bb367ebf778b371877d'}\n\n```{.r .cell-code}\n## Install necessary packages (if not already installed)\nif (!(\"lme4\" %in% installed.packages())) install.packages(\"lme4\")\nif (!(\"lmerTest\" %in% installed.packages())) install.packages(\"lmerTest\")\nif (!(\"tidyverse\" %in% installed.packages())) install.packages(\"tidyverse\")\nif (!(\"arrow\" %in% installed.packages())) install.packages(\"arrow\")\nif (!(\"afex\" %in% installed.packages())) install.packages(\"afex\")\nif (!(\"janitor\" %in% installed.packages())) install.packages(\"janitor\")\nif (!(\"skimr\" %in% installed.packages())) install.packages(\"skimr\")\nif (!(\"sdamr\" %in% installed.packages())) install.packages(\"sdamr\")\nif (!(\"formatR\" %in% installed.packages())) install.packages(\"formatR\")\nif (!(\"report\" %in% installed.packages())) install.packages(\"report\")\nif (!(\"easystats\" %in% installed.packages())) install.packages(\"easystats\")\nif (!(\"emmeans\" %in% installed.packages())) install.packages(\"emmeans\")\nif (!(\"poorman\" %in% installed.packages())) install.packages(\"poorman\")\nif (!(\"parameters\" %in% installed.packages())) install.packages(\"parameters\")\nif (!(\"modelbased\" %in% installed.packages())) install.packages(\"modelbased\")\nif (!(\"DT\" %in% installed.packages())) install.packages(\"DT\")\nif (!(\"data.table\" %in% installed.packages())) install.packages(\"data.table\")\nif (!(\"arsenal\" %in% installed.packages())) install.packages(\"arsenal\")\nif (!(\"kableExtra\" %in% installed.packages())) install.packages(\"kableExtra\")\nif (!(\"equatiomatic\" %in% installed.packages())) install.packages(\"equatiomatic\")\nif (!(\"gtsummary\" %in% installed.packages())) install.packages(\"gtsummary\")\n```\n:::\n\n</div>\nexample-text after code block\n\n### Load Packages\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/pckg-load_76ec1c2d1456e81345790512a1bd3445'}\n\n```{.r .fold-hide .cell-code}\n## Load packages\nlibrary(lme4)\nlibrary(lmerTest)\nlibrary(tidyverse)\nlibrary(arrow)\nlibrary(afex)\nlibrary(janitor)\nlibrary(skimr)\nlibrary(sdamr)\nlibrary(formatR)\nlibrary(report)\nlibrary(easystats)\nlibrary(emmeans)\nlibrary(poorman)\nlibrary(parameters)\nlibrary(modelbased)\nlibrary(DT)\nlibrary(data.table)\nlibrary(arsenal)\nlibrary(kableExtra)\nlibrary(equatiomatic)\nlibrary(gtsummary)\n```\n:::\n\n</div>\n\n### Config Options\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/config_143caef3d17445b318b3fd6abc3601bf'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, \n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220), fig.align='center', \n                      out.width='75%', fig.asp=.75)\n```\n:::\n\n</div>\n:::\n\n\n## Descriptives Overview\n::: {.panel-tabset}\n### Data Table {.tabset .tabset-fade .tabset-pills}\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/data-table_2993f0db12bfa8dbfde8e6fadabfad7d'}\n\n```{.r .cell-code}\ndf_long<- read_csv(\"/Users/shawes/Desktop/data/df_long.csv\")\n#df_long_sub<- read_csv(\"/Users/shawes/Desktop/df_long_sub.csv\")\n\n## Create a viewable 'datatable' of the primary dataframe (df)\ndatatable(head(df_long, 50, rownames = FALSE),extensions = 'AutoFill','ColReorder', options = list(autoFill = TRUE,colReorder = TRUE,\n  columnDefs = list(list(className = 'dt-center', targets = 10)),\n  order = list(list(3, 'asc'), list(4, 'desc')),\n  pageLength = 10,\n  lengthMenu = c(10, 15, 20),\n  initComplete = JS(\n    \"function(settings, json) {\",\n    \"$(this.api().table().header()).css({'background-color': '#808080', 'color': '#fff'});\",\n    \"}\")\n))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-86b5f064f8a094eeb9cc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-86b5f064f8a094eeb9cc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"AutoFill\"],\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\"],[1,1,1,2,2,2,3,4,4,4,5,5,5,6,6,6,7,7,8,8,8,9,9,9,10,10,11,11,11,12,12,12,13,13,14,14,14,15,15,15,16,16,16,17,17,17,18,19,20,20],[\"Year_1\",\"Baseline\",\"Year_2\",\"Year_2\",\"Year_1\",\"Baseline\",\"Baseline\",\"Year_1\",\"Year_2\",\"Baseline\",\"Year_2\",\"Baseline\",\"Year_1\",\"Year_1\",\"Baseline\",\"Year_2\",\"Baseline\",\"Year_1\",\"Baseline\",\"Year_2\",\"Year_1\",\"Year_2\",\"Baseline\",\"Year_1\",\"Year_1\",\"Baseline\",\"Baseline\",\"Year_1\",\"Year_2\",\"Year_2\",\"Baseline\",\"Year_1\",\"Baseline\",\"Year_1\",\"Year_1\",\"Year_2\",\"Baseline\",\"Year_1\",\"Baseline\",\"Year_2\",\"Year_1\",\"Baseline\",\"Year_2\",\"Baseline\",\"Year_2\",\"Year_1\",\"Baseline\",\"Year_2\",\"Baseline\",\"Year_2\"],[\"site061\",\"site061\",\"site061\",\"site101\",\"site101\",\"site101\",\"site22\",\"site071\",\"site071\",\"site071\",\"site20\",\"site20\",\"site20\",\"site12\",\"site12\",\"site12\",\"site17\",\"site17\",\"site03\",\"site03\",\"site03\",\"site11\",\"site11\",\"site11\",\"site17\",\"site17\",\"site06\",\"site06\",\"site06\",\"site04\",\"site04\",\"site04\",\"site12\",\"site12\",\"site14\",\"site14\",\"site14\",\"site12\",\"site12\",\"site12\",\"site17\",\"site17\",\"site17\",\"site06\",\"site06\",\"site06\",\"site04\",\"site04\",\"site19\",\"site19\"],[7731,7731,7731,9160,9160,9160,3672,2760,2760,2760,4305,4305,4305,1207,1207,1207,3101,3101,5019,5019,5019,7265,7265,7265,3102,3102,7730,7730,7730,1414,1414,1414,811,811,2642,2642,2642,812,812,812,3103,3103,3103,7732,7732,7732,1416,1416,6011,6011],[\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Female\",\"Female\"],[9,10,9,9,9,10,10,10,10,9,9,9,9,9,9,10,9,9,9,10,10,10,10,9,9,9,9,10,10,10,10,10,9,9,9,9,10,10,10,10,10,10,10,10,9,9,9,9,9,10],[37,1,0,1,0,0,0,1,1,0,1,1,0,0,0,3,1,0,1,1,3,3,3,3,0,0,0,0,1,0,0,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,3,2,0,0],[1,1,13,0,3,0,2,2,19,3,25,18,22,10,7,14,1,8,2,3,2,11,20,12,3,3,5,5,12,12,21,25,2,0,0,2,0,6,12,6,0,0,0,7,15,10,2,2,0,7],[7,7,7,7,3,0,4,4,5,2,2,7,9,28,1,1,4,2,11,11,11,11,28,4,26,6,3,3,3,3,28,3,23,16,6,8,6,2,5,3,7,4,5,2,6,7,28,6,11,7]],\"container\":\"<table class=\\\"ColReorder\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>ids<\\/th>\\n      <th>event<\\/th>\\n      <th>site_id<\\/th>\\n      <th>fam_id<\\/th>\\n      <th>sex<\\/th>\\n      <th>age<\\/th>\\n      <th>mature_vg<\\/th>\\n      <th>cbcl_extern<\\/th>\\n      <th>vg_total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"autoFill\":true,\"colReorder\":true,\"columnDefs\":[{\"className\":\"dt-center\",\"targets\":10},{\"className\":\"dt-right\",\"targets\":[1,4,6,7,8,9]},{\"orderable\":false,\"targets\":0}],\"order\":[[3,\"asc\"],[4,\"desc\"]],\"pageLength\":10,\"lengthMenu\":[10,15,20],\"initComplete\":\"function(settings, json) {\\n$(this.api().table().header()).css({'background-color': '#808080', 'color': '#fff'});\\n}\",\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[\"options.initComplete\"],\"jsHooks\":[]}</script>\n```\n:::\n\n```{.r .cell-code}\n## Not run: \n# Specify table size by pixels\n#kable(cbind(df_long, df_long), \"html\") %>%\n#    kable_styling() %>%\n#    scroll_box(width = \"100%\", height = \"500px\")\n```\n:::\n\n</div>\n\n### Descriptives\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/descriptives_0faa4459e7fd99d3eb20a2bb477a8edd'}\n\n```{.r .cell-code}\n## Create a descriptives table of study variables by measurement occasion \ndescriptives_1  <- tableby.control(test=FALSE, total=FALSE,\n                               numeric.test=\"kwt\", cat.test=\"chisq\",\n                               numeric.stats=c(\"N\", \"meansd\", \"median\", \"range\" \n                                               ), #\"Nmiss2\"\n                               cat.stats=c(\"countpct\"), #\"Nmiss2\"\n                               stats.labels=list(N='Count', meansd=\"Mean (SD)\", median\n                                                 ='Median', range='Min - Max'\n                                                 )) #, Nmiss2 ='Missing'\n\nmy_cont_labels <- list(\n  age = \"Age\",\n  vg_total = \"Weekly # of Video Gaming Hrs\",\n  cbcl_extern = \"CBCL Externalizing Scale\"\n)\n\ntab_descriptives_1 <- tableby(event ~ age + vg_total + \n                            cbcl_extern,\n                            data=df_long, control=descriptives_1)\n\n#summary(tab_descriptives_1, labelTranslations = my_cont_labels , text=TRUE, title = #\"Continuous Outcomes\", term.name = TRUE)\n\n# Push table object through kable and kable_styling\ntab_descriptives_1 %>%\n  summary(text=TRUE, digits.pct=1, digits=1) %>%\n  kable(caption = \"Continuous Outcomes\") %>%\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE, html_font = \"Cambria\",\n                font_size = 15,\n                position = \"center\", fixed_thead = T) %>%\n  row_spec(2:3,  bold = F, extra_css = 'vertical-align: middle !important;') %>%\n  column_spec(1, width = \"20em\", background = \"light grey\", bold = T, border_right = T) %>%\n  column_spec(2, width = \"20em\", border_right = T) %>%\n  column_spec(3, width = \"20em\", border_right = T) %>%\n  footnote(general = \"Here is a general comments of the table. \") %>%\n  scroll_box(width = \"75%\", height = \"500px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:75%; \"><table class=\"table table-striped\" style=\"font-size: 15px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption style=\"font-size: initial !important;\">Continuous Outcomes</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\">  </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\"> Baseline (N=35) </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\"> Year_1 (N=34) </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\"> Year_2 (N=30) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> age </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Count </td>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; border-right:1px solid;\"> 35 </td>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; border-right:1px solid;\"> 34 </td>\n   <td style=\"text-align:left;vertical-align: middle !important;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Mean (SD) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; border-right:1px solid;\"> 9.3 (0.5) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; border-right:1px solid;\"> 9.5 (0.5) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;\"> 9.6 (0.5) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Median </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 9.0 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 9.5 </td>\n   <td style=\"text-align:left;\"> 10.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Min - Max </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 9.0 - 10.0 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 9.0 - 10.0 </td>\n   <td style=\"text-align:left;\"> 9.0 - 10.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> vg_total </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Count </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 35 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 34 </td>\n   <td style=\"text-align:left;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Mean (SD) </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 8.7 (8.4) </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 8.7 (8.1) </td>\n   <td style=\"text-align:left;\"> 6.8 (4.3) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Median </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 6.0 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 7.0 </td>\n   <td style=\"text-align:left;\"> 7.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Min - Max </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.0 - 28.0 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.0 - 28.0 </td>\n   <td style=\"text-align:left;\"> 1.0 - 16.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> cbcl_extern </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Count </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 35 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 34 </td>\n   <td style=\"text-align:left;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Mean (SD) </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 4.8 (5.7) </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 5.5 (6.1) </td>\n   <td style=\"text-align:left;\"> 6.9 (6.9) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Median </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 3.0 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 4.0 </td>\n   <td style=\"text-align:left;\"> 4.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Min - Max </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.0 - 21.0 </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.0 - 25.0 </td>\n   <td style=\"text-align:left;\"> 0.0 - 25.0 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Here is a general comments of the table. </td></tr>\n</tfoot>\n</table></div>\n\n`````\n:::\n:::\n\n</div>\n\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/catvar-table_082255a367ca20db4014ba18ce75231b'}\n\n```{.r .cell-code}\n## Create a descriptives table of study variables by measurement occasion \ndescriptives_2  <- tableby.control(test=FALSE, total=FALSE,\n                               numeric.test=\"kwt\", cat.test=\"chisq\",\n                               numeric.stats=c(\"N\", \"meansd\", \"median\", \"range\"\n                                               ), # \"Nmiss2\"\n                               cat.stats=c(\"countpct\"), # \"Nmiss2\"\n                               stats.labels=list(N='Count', meansd=\"Mean (SD)\", median\n                                                 ='Median', range='Min - Max'\n                                                 )) # , Nmiss2 ='Missing'\n\nmy_cat_labels  <- list(\n  event = \"Year\",\n  sex = \"Sex\",\n  mature_vg = \"Mature Video Games\"\n  )\n\ntab_descriptives_2 <- tableby(event ~ sex + mature_vg, \n                            data=df_long, control=descriptives_2)\n\n#summary(tab_descriptives_2, labelTranslations = my_cat_labels , text=TRUE, title = #\"Categorical Outcomes\", term.name = TRUE)\n\n# Push table object through kable and kable_styling\ntab_descriptives_2 %>%\n  summary(text=TRUE, digits.pct=1, digits=1) %>%\n  kable(caption = \"Categorical Outcomes\") %>%\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE, font_size = 15,\n                position = \"center\", fixed_thead = T) %>%\n  row_spec(2:3,  bold = F, extra_css = 'vertical-align: middle !important;') %>%\n  column_spec(1, width = \"20em\", background = \"light grey\", bold = T, border_right = T) %>%\n  column_spec(2, width = \"20em\", border_right = T) %>%\n  #column_spec(3, width = \"20em\", border_right = T) %>%\n  footnote(general = \"Here is a general comments of the table. \") %>%\n  scroll_box(width = \"75%\", height = \"500px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:75%; \"><table class=\"table table-striped\" style=\"font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption style=\"font-size: initial !important;\">Categorical Outcomes</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\">  </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\"> Baseline (N=35) </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\"> Year_1 (N=34) </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;\"> Year_2 (N=30) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> sex </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Female </td>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; border-right:1px solid;\"> 19 (54.3%) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;\"> 20 (58.8%) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;\"> 17 (56.7%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Male </td>\n   <td style=\"text-align:left;vertical-align: middle !important;width: 20em; border-right:1px solid;\"> 16 (45.7%) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;\"> 14 (41.2%) </td>\n   <td style=\"text-align:left;vertical-align: middle !important;\"> 13 (43.3%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> mature_vg </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Count </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 35 </td>\n   <td style=\"text-align:left;\"> 34 </td>\n   <td style=\"text-align:left;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Mean (SD) </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.6 (0.9) </td>\n   <td style=\"text-align:left;\"> 1.7 (6.3) </td>\n   <td style=\"text-align:left;\"> 0.6 (0.9) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Median </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 20em; font-weight: bold;background-color: light grey !important;border-right:1px solid;\"> -  Min - Max </td>\n   <td style=\"text-align:left;width: 20em; border-right:1px solid;\"> 0.0 - 3.0 </td>\n   <td style=\"text-align:left;\"> 0.0 - 37.0 </td>\n   <td style=\"text-align:left;\"> 0.0 - 3.0 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Here is a general comments of the table. </td></tr>\n</tfoot>\n</table></div>\n\n`````\n:::\n:::\n\n</div>\n:::\n\n## Results \n::: {.panel-tabset}\n### Build Model {.tabset .tabset-fade .tabset-pills}\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/build-model_3018a27d75b75f44a0be379334c9698f'}\n\n```{.r .cell-code}\n## Linear Mixed Model with a random intercept (LMM-ri)\nrandom_intercepts <- lmer(cbcl_extern ~ 1 + event + sex + (1|ids), data = df_long, REML=T)\n\nprint(random_intercepts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerModLmerTest']\nFormula: cbcl_extern ~ 1 + event + sex + (1 | ids)\n   Data: df_long\nREML criterion at convergence: 588.7995\nRandom effects:\n Groups   Name        Std.Dev.\n ids      (Intercept) 5.020   \n Residual             3.587   \nNumber of obs: 99, groups:  ids, 37\nFixed Effects:\n(Intercept)  eventYear_1  eventYear_2      sexMale  \n     4.3204       0.7650       1.7481       0.5837  \n```\n:::\n:::\n\n</div>\n\n> The code snippet above tells R to run a linear mixed model using lmer\n> from the lme4 library. The left side of the \"\\~\" symbol specifies the\n> dependent variable; the right side specifies days as the independent\n> variable(s). The code (1 \\| Subject) specifies a random intercept for\n> each subject.\n\n### Model Output\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/model-output_3083f990489365c114103092ca5d408b'}\n\n```{.r .cell-code  code-summary=\"testing\"}\n## Output and reports extending from the LMM-ri analyses\nsummary(random_intercepts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: cbcl_extern ~ 1 + event + sex + (1 | ids)\n   Data: df_long\n\nREML criterion at convergence: 588.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.7239 -0.4710 -0.1888  0.2910  2.9047 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ids      (Intercept) 25.20    5.020   \n Residual             12.86    3.587   \nNumber of obs: 99, groups:  ids, 37\n\nFixed effects:\n            Estimate Std. Error      df t value Pr(>|t|)   \n(Intercept)   4.3204     1.3277 46.9852   3.254  0.00211 **\neventYear_1   0.7650     0.8768 62.6158   0.873  0.38626   \neventYear_2   1.7481     0.9173 63.4712   1.906  0.06123 . \nsexMale       0.5837     1.8240 36.0452   0.320  0.75081   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) evnY_1 evnY_2\neventYear_1 -0.343              \neventYear_2 -0.317  0.475       \nsexMale     -0.631  0.032  0.013\n```\n:::\n\n```{.r .cell-code  code-summary=\"testing\"}\nconfint(random_intercepts, level = 0.95, method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  2.5 %   97.5 %\n.sig01               NA       NA\n.sigma               NA       NA\n(Intercept)  1.71808695 6.922714\neventYear_1 -0.95342829 2.483383\neventYear_2 -0.04987969 3.546050\nsexMale     -2.99121329 4.158581\n```\n:::\n\n```{.r .cell-code  code-summary=\"testing\"}\nreport(random_intercepts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWe fitted a linear mixed model (estimated using REML and nloptwrap optimizer)\nto predict cbcl_extern with event and sex (formula: cbcl_extern ~ 1 + event +\nsex). The model included ids as random effect (formula: ~1 | ids). The model's\ntotal explanatory power is substantial (conditional R2 = 0.67) and the part\nrelated to the fixed effects alone (marginal R2) is of 0.02. The model's\nintercept, corresponding to event = Baseline and sex = Female, is at 4.32 (95%\nCI [1.68, 6.96], t(93) = 3.25, p = 0.002). Within this model:\n\n  - The effect of event [Year_1] is statistically non-significant and positive\n(beta = 0.76, 95% CI [-0.98, 2.51], t(93) = 0.87, p = 0.385; Std. beta = 0.12,\n95% CI [-0.16, 0.40])\n  - The effect of event [Year_2] is statistically non-significant and positive\n(beta = 1.75, 95% CI [-0.07, 3.57], t(93) = 1.91, p = 0.060; Std. beta = 0.28,\n95% CI [-0.01, 0.58])\n  - The effect of sex [Male] is statistically non-significant and positive (beta\n= 0.58, 95% CI [-3.04, 4.21], t(93) = 0.32, p = 0.750; Std. beta = 0.09, 95% CI\n[-0.49, 0.68])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n:::\n\n```{.r .cell-code  code-summary=\"testing\"}\nreport_performance(random_intercepts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe model's total explanatory power is substantial (conditional R2 = 0.67) and\nthe part related to the fixed effects alone (marginal R2) is of 0.02\n```\n:::\n\n```{.r .cell-code  code-summary=\"testing\"}\nreport_statistics(random_intercepts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbeta = 4.32, 95% CI [1.68, 6.96], t(93) = 3.25, p = 0.002; Std. beta = -0.22, 95% CI [-0.64, 0.21]\nbeta = 0.76, 95% CI [-0.98, 2.51], t(93) = 0.87, p = 0.385; Std. beta = 0.12, 95% CI [-0.16, 0.40]\nbeta = 1.75, 95% CI [-0.07, 3.57], t(93) = 1.91, p = 0.060; Std. beta = 0.28, 95% CI [-0.01, 0.58]\nbeta = 0.58, 95% CI [-3.04, 4.21], t(93) = 0.32, p = 0.750; Std. beta = 0.09, 95% CI [-0.49, 0.68]\n```\n:::\n\n```{.r .cell-code  code-summary=\"testing\"}\nrandom <- estimate_grouplevel(random_intercepts)\n```\n:::\n\n</div>\n\n### Model Report\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/mod-report_be6d8355898444bc81d86031e79d22db'}\n\n```{.r .cell-code}\n#df_long %>%\n#  report() %>%\n#  summary()\n```\n:::\n\n</div>\n:::\n\n## Visualizations \n::: {.panel-tabset}\n### Extract Params {.tabset .tabset-fade .tabset-pills}\n<div class = \"blue\">\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/extrct-FE_0827f4b630cb93461432a0bbf969153c'}\n\n```{.r .cell-code}\n## Obtain LMM-ri model parameters to plot/graph of results\nmodel_intercept <- as.numeric(fixef(random_intercepts)[1])\nmodel_slope <- as.numeric(fixef(random_intercepts)[2])\n```\n:::\n\n</div>\n\n> This code allows for extracting the fixed effects estimates for the\n> model intercept and slope.\n\n<div class = \"blue\">\n\n::: {.cell hash='3a_HowTos_LinearMixedModels_cache/html/extrct-RE_008f1b9c661c81e78551a552589d309c'}\n\n:::\n\n</div>\n\n> Extract the individual participant intercepts (random effects) for this model and add\n> it to the data frame for plotting\n\n### Diagnostic Plots\n<div class = \"blue\">\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"2\" messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/diag-plots_65f49891a93a44b781054b2357700027'}\n::: {.cell-output-display}\n![](3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](3a_HowTos_LinearMixedModels_files/figure-html/diag-plots-5.png){width=672}\n:::\n:::\n\n</div>\n\n> Build diagnostic plots. Observations with a Bonferroni p \\< .05 might\n> be considered as outliers and might need further investigation.\n\n### Bar Plot\n\n::: {.cell messages='false' hash='3a_HowTos_LinearMixedModels_cache/html/barplot_08b7b2314a0caee13c8e4cc765e7a154'}\n\n```{.r .cell-code}\n# Basic ggplot2 barplot with mean\np<-df_long %>%\n    filter(!is.na(mature_vg)) %>% # filter on non-missing values  \n    ggplot(aes(x = mature_vg, y = cbcl_extern, fill = sex)) +\n    geom_col(position = \"dodge\",\n           stat = \"summary\",\n           fun = \"mean\",\n           #fill = \"#AA4A44\",\n           #color = \"#0099f9\"\n           ) +\n    #scale_fill_brewer(palette = \"Set1\") +\n    scale_fill_manual(values = c(\"#3db5ff\", \"#0099f9\")) +\n    #scale_fill_gradient(high = \"#B00B69\", low = \"#0e0e63\") +\n    #geom_text(aes(label = cu_traits), position = position_dodge(0.9), \n              #vjust = 2, size = 4, color = \"#ffffff\") +\n    labs(title = \"Behavior Problems by Video Game Groups\", subtitle = \"Simple bar chart\",\n         caption = \"Simple caption\", x = \"DBD Group\", y = \"CBCL Externalizing\") +\n              #coord_flip() +\n    #geom_hline(yintercept = mean(df$cbcl_agg), linetype = \"dashed\", size = 1) +\n    theme_minimal() +\n    theme(\n          plot.title = element_text(color = \"#0099f9\", size = 20, hjust = 0.5),\n          plot.subtitle = element_text(face = \"bold\", hjust = 1),\n          plot.caption = element_text(face = \"italic\", hjust = 0),\n          axis.title.x = element_text(color = \"#0099f9\", size = 15, face = \"bold\"),\n          axis.title.y = element_text(size = 15, face = \"italic\")\n  )\np\n```\n\n::: {.cell-output-display}\n![](3a_HowTos_LinearMixedModels_files/figure-html/barplot-1.png){width=672}\n:::\n:::\n\n\n### Random Intercept LMM Plot/Graph\n<div class = \"blue\">\n\n::: {.cell messages='false' fig.asp='0.61' hash='3a_HowTos_LinearMixedModels_cache/html/my-figure_76209778dc4652a350e64354d1a442b4'}\n\n```{.r .cell-code}\n#random_intercepts <- lmer(Externalizing ~ 1 + Event + DBD + Sex + (1|ids), data = df, #REML=T)\n\n## LMM-ri plot of estimated random intercepts \nmodel <- lmer(cbcl_extern ~ mature_vg + (1 | sex), data = df_long)\npreds <- estimate_relation(model, include_random = TRUE)\n\n## Adding fixed effect trajectory to LMM-ri plot \nfixed_pred <- estimate_relation(model) # This time, include_random is FALSE (default)\nplot(preds, ribbon = list(alpha = 0)) + # Previous plot\n  geom_ribbon(data = fixed_pred, aes(x = mature_vg, ymin = CI_low, ymax = CI_high), alpha = 0.4) +\n  geom_line(data = fixed_pred, aes(x = mature_vg, y = Predicted), size = 2)\n```\n\n::: {.cell-output-display}\n![This is a caption for my figure,\nusing YAML formatting, etc.#|](3a_HowTos_LinearMixedModels_files/figure-html/my-figure-1.png){width=672}\n:::\n\n```{.r .cell-code}\n######\n# ggplot(df_long_sub, aes(x = event, y = cbcl_agg, color=sex, shape=sex)) + \n# geom_abline(slope = model_slope, intercept = model_intercept, linetype = \"solid\", color = \"red\", linewidth = 1) + \n# geom_point(color = \"grey70\") + \n# geom_smooth(method=lm, se=FALSE, fullrange=TRUE)+\n# scale_shape() + \n# geom_segment(aes(x = event, xend = event, y = cbcl_agg, yend = fitted(cbcl_agg)), color = \"grey70\") + \n# scale_y_continuous(expand = c(0, 0), breaks = c(0, 20, 40, 60, 80, 100), limits = c(0, 100)) + \n# scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4), limits = c(0, 4)) +\n# theme(panel.background = element_blank(),         \n#         panel.grid.major = element_blank(),\n#         panel.grid.minor = element_blank(),\n#         panel.border = element_rect(colour = \"black\", fill = NA),\n#         legend.position = \"none\",\n#         axis.text = element_text(size = 14), \n#         axis.title = element_text(size = 14)) +\n#         labs (x = \"Event\", y= \"CBCL Aggression\")\n\n#Save the plot\n#ggsave(\"random_intercept.png\", units = \"in\", width = 9, height = 6, dpi = 300)  \n```\n:::\n\n</div>\n:::\n\n<p class=\"text-center\" style=\"background-color: gray\">Figure x: The overall group-mean (fixed effects) trajectory is shown in blue. The faded lines represent each individual youth's estimated trajectory. An examination of this figure shows happiness scores to be increasing across measurement occasions, however, there appears to be substantial variability in the youth's initial happiness scores.</p>\n\n#### Interpretation\nThe estimated correlation between x and y was \"r cor(x,y)`.\nThere are \"r nrow(my_data)` individuals.\n\nFrom the fixed effects section of the model summary, we can conclude\nthat there is strong evidence that RT increased significantly over time\n(i.e., \\# of years). On average for each additional year, RT increased\nby 10.46 (b = 10.46, SE = 0.80, p \\< .001).We are 95% confident that the\naverage increase was between 8.89 and 12.04.\n\nIn the above, we estimate that the average intercept across all\nparticipants is 251.4. Results from the random effects section below\nshow that the variance of the intercept for Subject is 1378.2. Taking\nthe square root, the standard deviation of the intercept is thus 37.1.\n\nWe can calculate the 95% coverage interval as 251.4 ± 1.96\\*37.1. The\nlower bound of the 95% coverage interval is thus 178.7 and the upper\nbound is 324.1. We therefore estimated that 95% of the participants have\nan intercept between 178.7 and 324.1. This means that 95% of the\nparticipants have a reaction time between 178.7 and 324.1 at Day 0. This\nis not to be confused with the 95% confidence interval of the intercept.\nThe 95% confidence interval is (232.3, 270.5), and this indicates that\nwe are 95% confident that the average intercept is somewhere between\n232.3 and 270.5.\n\nIn this model, we have accounted for the repeated measures design\n(observations nested within individuals) by including a random intercept\nfor each participants. Each individual has his/her own intercept. The\neffect of time(Year) on RT is assumed to be the same across individuals.\nThis assumption can be relaxed by fitting a random slope model.\n\n#### Mock Write-up\n\nA random slope model is used to test if sleep deprivation affects\nreaction time. To account for the repeated measures design, a random\nintercept was specified for participants. The random slope for days of\nsleep deprivation was included in the model to allow the effect of sleep\ndeprivation to vary across participants. Results are shown in Table 1.\nUsing a significant level of 0.05, results indicate that sleep\ndeprivation significantly increased reaction time. On average, each\nadditional day of sleep deprivation increased reaction time by 10.47ms\n(b = 10.47, 95% CI = \\[7.44, 13.50\\], p \\< .001). Model fit comparison\nbetween model with and without random slope for sleep deprivation shows\nthat the effect of sleep deprivation varied across participants, χ2(2)=\n42.14, p \\< .001. The 95% coverage interval for the random slope of\nsleep deprivation is (-1.14, 22.07), indicating that the effect of sleep\ndeprivation was between -1.14 and 22.07 for 95% of the participants.\n:::\n\n## References\n\n[@brown2021] <!-- [@Singmann2019]\n[@sarafian]\n[#@https://m-clark.github.io/]\n[#@Fitzmaurice]\n[#@mspeekenbrink.github.io]\n[#https://cran.r-project.org/web/packages/lme4/lme4.pdf] -->\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.27/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js\"></script>\n<link href=\"site_libs/dt-ext-autofill-1.12.1/css/autoFill.dataTables.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-ext-autofill-1.12.1/js/dataTables.autoFill.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}