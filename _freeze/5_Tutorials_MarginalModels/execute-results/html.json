{
  "hash": "caab9cdda72707c18a7cffe09c04c54b",
  "result": {
    "markdown": "---\ntitle: \"Marginal Models\"\nauthor: \"Biostatistics Working Group\"\nformat:\n  html:\n    mermaid:\n      theme: forest\n---\n\n\n\nxxxxxxxxx\n\n\n\n```{mermaid}\ngraph LR\nA(( )) -- Intercept --> B(( ))\nB -- Slope --> C(( ))\nC -- Quadratic --> D(( ))\n\nB -- Y1 --> E[square]\nC -- Y2 --> F[square]\nD -- Y3 --> G[square]\n```\n\n\n\n\nxxxxxxxx\n\n## Overview\nMarginal models are a statistical method used to analyze longitudinal or clustered data. The marginal model estimates the average effect of the independent variables on the outcome while accounting for the within-subject correlation, and allows for the estimation of population-averaged effects, in contrast to subject-specific effects estimated by random-effects models (Verbeke & Molenberghs, 2000). The method is similar to the GEE approach but uses a different estimation technique and does not account for subject-specific effects. Marginal models have been shown to be robust to non-normality and non-constant variance, and can handle unbalanced or unequally spaced data (Fitzmaurice et al., 2011). The term marginal in this context is used to emphasize that the model for the mean response at each occasion depends only on the covariates of interest, and not on any random effects or previous responses. \n\n[+add diagrams/figures]\n\n### When to use Longitudinal Marginal Models\nYou should use xxxxxxx in the following scenario:\n\n1.\tYou want to know xxxxx\n2.\tYour variable xxxxx\n3.\tYou have xxxxx \n\n### Getting Started with Longitudinal Marginal Models\n\nIn this tutorial, we will introduce the concept of longitudinal marginal models and guide you through a simple example using a small dataset. By the end of this tutorial, you will be able to:\n\n1. Understand the basic concepts of longitudinal marginal models.\n2. Fit a longitudinal marginal model using example data in R.\n3. Interpret the results of the model.\n\n## Basic Example\n\nFor this tutorial, we will use a simple dataset containing the following information for a group of individuals:\n\n- Subject ID\n- Time (in years)\n- Binary outcome variable (e.g., presence or absence of a particular condition)\n\n| Subject ID | Time | Outcome |\n|------------|------|---------|\n| 1          | 0    | 0       |\n| 1          | 1    | 1       |\n| 1          | 2    | 1       |\n| 2          | 0    | 0       |\n| 2          | 1    | 1       |\n\n### Model Specification and Estimation\n\nWe will use the `geepack` package in R to fit a longitudinal marginal model. First, install and load the required package:\n\n\n::: {.cell hash='5_Tutorials_MarginalModels_cache/html/unnamed-chunk-2_5ebc53d5d2a3fb4651e45d60b65e0f6b'}\n\n```{.r .cell-code}\nif (!(\"lme4\" %in% installed.packages())) install.packages(\"geepack\")\nlibrary(geepack)\n```\n:::\n\n\nNext, create a data frame with the example data:\n\n\n::: {.cell hash='5_Tutorials_MarginalModels_cache/html/unnamed-chunk-3_c2caabc05ab09ac0b4128db9141031d8'}\n\n```{.r .cell-code}\ndata <- data.frame(\n  subject_id = c(1, 1, 1, 2, 2),\n  time = c(0, 1, 2, 0, 1),\n  outcome = c(0, 1, 1, 0, 1)\n)\n```\n:::\n\n\nFit the longitudinal marginal model with a binary outcome using a logit link function:\n\n\n::: {.cell hash='5_Tutorials_MarginalModels_cache/html/unnamed-chunk-4_396611aed468a8a02b4bd2e9c00f5690'}\n\n```{.r .cell-code}\nmodel <- geeglm(outcome ~ time, data = data, id = subject_id, family = binomial(link = \"logit\"), corstr = \"exchangeable\")\n```\n:::\n\n\n### Interpreting the Results\nTo interpret the results of the longitudinal marginal model, we can use the summary() function in R to display the estimated population-averaged effects:\n\n\n::: {.cell hash='5_Tutorials_MarginalModels_cache/html/unnamed-chunk-5_a0ae463dce96acc6464abc89d8ed95ad'}\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\ngeeglm(formula = outcome ~ time, family = binomial(link = \"logit\"), \n    data = data, id = subject_id, corstr = \"exchangeable\")\n\n Coefficients:\n            Estimate Std.err Wald Pr(>|W|)\n(Intercept)   -43.54     NaN  NaN      NaN\ntime           82.78     NaN  NaN      NaN\n\nCorrelation structure = exchangeable \nEstimated Scale Parameters:\n\n            Estimate Std.err\n(Intercept) 2.22e-16     NaN\n  Link = identity \n\nEstimated Correlation Parameters:\n      Estimate Std.err\nalpha     -0.5     NaN\nNumber of clusters:   2  Maximum cluster size: 3 \n```\n:::\n:::\n\n\nThe output will show the estimated effect of time on the binary outcome variable, expressed as an odds ratio. By examining the odds ratio and its associated p-value, we can determine if the change in the outcome variable over time is significant at the population level.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}